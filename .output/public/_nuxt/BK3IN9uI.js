import{e as M,f as N,g as D,r as d,h as w,i as R,j as I,c as o,o as n,a as e,n as g,k as h,F as k,l as F,m as L,t as c,p as O,v as B,q as P}from"./OScbCsOj.js";import{_ as x}from"./DlAUqK2U.js";const H={class:"maps-page"},V={class:"container"},Y={class:"page-header"},G={class:"tabs"},U={key:0,class:"map-grid"},q={class:"card-header"},z={key:0,class:"rating-tag"},J={key:1,class:"rating-tag empty"},K={class:"date"},j={class:"map-title"},Q={class:"map-info"},W={class:"creator"},X={class:"duration"},Z={class:"actions"},tt=["onClick"],et=["onClick"],st=["onClick"],at=["onClick"],ot=["onClick"],nt={key:0,class:"rename-modal"},lt={class:"modal-content glass-panel"},it={class:"modal-actions"},ct={key:1,class:"empty-state"},rt={key:1,class:"loading-state"},dt=M({__name:"maps",setup(ut){const{user:C}=N(),f=D(),l=d("my"),u=d([]),v=d(!0),i=d(null),r=d(""),p=async()=>{v.value=!0;try{const s=l.value==="my"?C.value?.username||"Guest":void 0,t=l.value==="shared"?"true":void 0;u.value=await $fetch("/api/maps",{query:{creator:s,shared:t}})}catch(s){console.error("Fetch maps error:",s)}finally{v.value=!1}},m=w(()=>u.value),A=async s=>{try{const t=await $fetch(`/api/maps/${s._id}`);sessionStorage.setItem("umm_load_map",JSON.stringify(t)),f.push("/play")}catch{alert("Failed to load map data.")}},E=async s=>{try{const t=await $fetch(`/api/maps/${s._id}`);sessionStorage.setItem("umm_edit_map",JSON.stringify(t)),f.push("/editor")}catch{alert("Failed to load map data.")}},b=async s=>{if(confirm(`Are you sure you want to delete "${s.title}"?`))try{await $fetch(`/api/maps/${s._id}`,{method:"DELETE"}),u.value=u.value.filter(t=>t._id!==s._id)}catch{alert("Map deletion failed.")}},S=s=>{i.value=s,r.value=s.title},y=async()=>{if(!(!i.value||!r.value.trim()))try{const s=await $fetch(`/api/maps/${i.value._id}`,{method:"PATCH",body:{title:r.value.trim()}});i.value.title=s.title,i.value=null}catch{alert("Rename failed.")}},$=async s=>{try{const t=await $fetch(`/api/maps/${s._id}`,{method:"PATCH",body:{isShared:!s.isShared}});s.isShared=t.isShared}catch{alert("Toggle share failed.")}},T=s=>s<4?"#00ff88":s<7?"#ffff00":"#ff4444";return R(l,p),I(p),(s,t)=>(n(),o("div",H,[t[6]||(t[6]=e("div",{class:"background-anim"},null,-1)),e("div",V,[e("header",Y,[t[4]||(t[4]=e("h1",{class:"title"},"MAP_DATABASE",-1)),e("div",G,[e("button",{class:g(["tab-btn",{active:l.value==="my"}]),onClick:t[0]||(t[0]=a=>l.value="my")}," MY_ENTRIES ",2),e("button",{class:g(["tab-btn",{active:l.value==="shared"}]),onClick:t[1]||(t[1]=a=>l.value="shared")}," GLOBAL_UPLOADS ",2)])]),v.value?(n(),o("div",rt," ACCESSING DATABASE... ")):(n(),o("div",U,[(n(!0),o(k,null,F(m.value,a=>(n(),o("div",{key:a._id,class:"map-card"},[e("div",q,[e("span",{class:"diff-tag",style:L({color:T(a.difficulty)})}," DIFF: "+c(a.difficulty),5),a.rating>0?(n(),o("span",z," RATE: â˜…"+c(a.rating),1)):(n(),o("span",J," RATE: - ")),e("span",K,c(new Date(a.createdAt).toLocaleDateString()),1)]),e("h3",j,c(a.title),1),e("div",Q,[e("span",W,"BY: "+c(a.creatorName),1),e("span",X,c(Math.floor(a.duration))+"s",1)]),e("div",Z,[e("button",{onClick:_=>A(a),class:"action-btn play"},"PLAY",8,tt),l.value==="my"?(n(),o(k,{key:0},[e("button",{onClick:_=>E(a),class:"action-btn edit"},"EDIT",8,et),e("button",{onClick:_=>S(a),class:"action-btn rename"},"RENAME",8,st),e("button",{onClick:_=>$(a),class:"action-btn share"},c(a.isShared?"PRIVATE":"SHARE"),9,at),e("button",{onClick:_=>b(a),class:"action-btn delete"},"DEL",8,ot)],64)):h("",!0)])]))),128)),i.value?(n(),o("div",nt,[e("div",lt,[t[5]||(t[5]=e("h3",null,"RENAME_ENTRY",-1)),O(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>r.value=a),placeholder:"Enter new title...",onKeyup:P(y,["enter"])},null,544),[[B,r.value]]),e("div",it,[e("button",{onClick:y,class:"confirm"},"CONFIRM"),e("button",{onClick:t[3]||(t[3]=a=>i.value=null),class:"cancel"},"CANCEL")])])])):h("",!0),m.value.length===0?(n(),o("div",ct," NO DATA FOUND IN THIS SECTOR ")):h("",!0)]))])]))}}),ht=x(dt,[["__scopeId","data-v-5846ad1c"]]);export{ht as default};
