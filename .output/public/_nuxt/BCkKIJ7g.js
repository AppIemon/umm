import{e as Ue,f as be,r as p,j as Be,C as Ve,c as E,a as n,k as B,d as $,p as x,v as M,t as T,B as de,n as j,F as ee,l as te,s as We,D as Ye,m as Ge,g as Xe,o as O}from"./BrYDLEIV.js";import{G as ve}from"./DR3fCXgQ.js";import{C as he,s as Fe}from"./CUbsk6PR.js";import{_ as He}from"./DlAUqK2U.js";const $e={class:"editor-page"},Je={class:"editor-header glass-panel"},ze={class:"left"},Ke={class:"map-meta"},Ze={class:"creator"},qe={class:"center"},Qe={class:"transport-controls"},je={class:"right"},et={class:"config-summary"},tt={class:"stat"},lt={class:"stat"},at={class:"main-layout"},nt={class:"sidebar left-sidebar glass-panel"},it={class:"object-list"},st=["onClick"],ot={class:"symbol"},ut={class:"name"},rt=["onClick"],dt={class:"symbol"},vt={class:"name"},ht={class:"grid-info"},ct={class:"timeline-container"},ft=["max"],gt={class:"sidebar right-sidebar glass-panel"},mt={key:0,class:"properties-list"},pt={class:"prop-group"},yt={class:"prop-val-static"},wt={class:"prop-group"},xt={class:"input-pair"},Mt={class:"prop-group"},Tt={class:"input-pair"},kt={key:0,class:"prop-group"},St={class:"rotation-controls"},Et={key:1,class:"prop-group"},Ot={key:1,class:"movement-details"},Pt={key:1,class:"properties-list"},_t={class:"prop-group"},Ct={class:"prop-val-static"},It={key:2,class:"empty-selection"},At={class:"global-settings prop-group"},Dt={class:"audio-settings prop-group"},Lt={class:"audio-upload"},Rt={key:0,class:"audio-hint"},Nt={key:0,class:"modal-overlay"},Ut={class:"modal-box glass-panel"},bt={class:"progress-section"},Bt={class:"progress-bar"},Vt={class:"status-text"},Wt={class:"log-console"},Yt={class:"modal-actions"},Gt=["disabled"],Xt=Ue({__name:"editor",setup(Ft){const J=Xe(),{user:le}=be(),V=new ve,o=p({title:"NEW UNTITLED MAP",duration:60,difficulty:10,engineObstacles:[],enginePortals:[],beatTimes:[],sections:[],seed:0,bpm:120,measureLength:2}),G=p(60*350+500),c=p(0),f=p(1),s=p([]),W=p("spike"),Y=p(!0),ce=p(null),w=p(null),ae=p(null),z=["spike","block","saw","mini_spike","laser","spike_ball","v_laser","mine","orb","slope"],fe=["gravity_yellow","gravity_blue","speed_0.25","speed_0.5","speed_1","speed_2","speed_3","speed_4","mini_pink","mini_green"],ge=e=>V.getPortalSymbol(e)||"â– ",me=e=>V.getPortalSymbol(e),I=p([]),A=p(-1),R=p([]),L=p(!1),N=p(!1),y=p({x1:0,y1:0,x2:0,y2:0}),ne=p(!1),pe=p([]),K=p(0),ye=p(""),we=p(!1),xe=e=>({idle:"IDLE",analyzing_song:"SONG ANALYSIS",generating_path:"MOVEMENT PATH GENERATION",adjusting_path:"MOVEMENT PATH ADJUSTMENT",generating_map:"MAP GENERATION",adjusting_map:"MAP ADJUSTMENT",saving_map:"MAP SAVING",completed:"COMPLETED",failed:"FAILED"})[e]||e.toUpperCase().replace("_"," "),U=()=>{const e=JSON.stringify(o.value);I.value[A.value]!==e&&(I.value=I.value.slice(0,A.value+1),I.value.push(e),I.value.length>50?I.value.shift():A.value++)},Me=()=>{A.value>0&&(A.value--,o.value=JSON.parse(I.value[A.value]))},Te=()=>{A.value<I.value.length-1&&(A.value++,o.value=JSON.parse(I.value[A.value]))};let Z=!1,X=!1,F=!1,b="",ie=0,se=0,q=new Map;const ke=(e,l,a)=>{const u=10/f.value;return Math.abs(e-a.x)<u&&Math.abs(l-a.y)<u?"tl":Math.abs(e-(a.x+a.width))<u&&Math.abs(l-a.y)<u?"tr":Math.abs(e-a.x)<u&&Math.abs(l-(a.y+a.height))<u?"bl":Math.abs(e-(a.x+a.width))<u&&Math.abs(l-(a.y+a.height))<u?"br":null},Se=e=>{if(e.button===1){Z=!0,ie=e.clientX,se=c.value,e.preventDefault();return}if(e.button===2){if(!w.value)return;N.value=!0;const t=w.value.getBoundingClientRect(),i=w.value.width/t.width,m=w.value.height/t.height,r=(e.clientX-t.left)*i/f.value+c.value,v=(e.clientY-t.top)*m/f.value;y.value={x1:r,y1:v,x2:r,y2:v},e.preventDefault();return}if(e.button!==0||!w.value)return;const l=w.value.getBoundingClientRect(),a=w.value.width/l.width,u=w.value.height/l.height;let d=(e.clientX-l.left)*a/f.value+c.value,g=(e.clientY-l.top)*u/f.value;if(L.value&&(d=Math.round(d/25)*25,g=Math.round(g/25)*25),s.value.length===1){const t=ke(d,g,s.value[0]);if(t){F=!0,b=t;return}}const h=_e(d,g);if(h){if(L.value){const t=s.value.indexOf(h);t===-1?s.value.push(h):s.value.splice(t,1)}else s.value.includes(h)||(s.value=[h]);s.value.includes(h)&&(X=!0,q.clear(),s.value.forEach(t=>{q.set(t,{x:t.x-d,y:t.y-g})}))}else L.value||(s.value=[]),Ce(d,g),U()},Ee=e=>{if(!w.value)return;const l=w.value.getBoundingClientRect(),a=w.value.width/l.width,u=w.value.height/l.height;let d=(e.clientX-l.left)*a/f.value+c.value,g=(e.clientY-l.top)*u/f.value;const h=d,t=g;if(L.value&&!N.value&&(d=Math.round(d/25)*25,g=Math.round(g/25)*25),Z){const i=e.clientX-ie;c.value=Math.max(0,se-i/f.value)}else if(N.value)y.value.x2=h,y.value.y2=t;else if(F&&s.value.length===1){const i=s.value[0];if(b==="br")i.width=Math.max(10,d-i.x),i.height=Math.max(10,g-i.y);else if(b==="bl"){const m=i.x+i.width;i.x=Math.min(m-10,d),i.width=m-i.x,i.height=Math.max(10,g-i.y)}else if(b==="tr"){const m=i.y+i.height;i.y=Math.min(m-10,g),i.height=m-i.y,i.width=Math.max(10,d-i.x)}else if(b==="tl"){const m=i.x+i.width,r=i.y+i.height;i.x=Math.min(m-10,d),i.y=Math.min(r-10,g),i.width=m-i.x,i.height=r-i.y}}else X&&s.value.forEach(i=>{const m=q.get(i);if(m){let r=h+m.x,v=t+m.y;L.value&&(r=Math.round(r/25)*25,v=Math.round(v/25)*25),i.x=r,i.y=v,"initialY"in i&&(i.initialY=v);const P=r+i.width,_=o.value.duration*350+500;if(P>_-400){const k=Math.ceil((P-500+1e3)/350);k>o.value.duration&&(o.value.duration=k,Q())}}})},Oe=()=>{if(N.value){const e=Math.min(y.value.x1,y.value.x2),l=Math.max(y.value.x1,y.value.x2),a=Math.min(y.value.y1,y.value.y2),u=Math.max(y.value.y1,y.value.y2),d=h=>{const t=h.x,i=h.x+h.width,m=h.y,r=h.y+h.height;return!(i<e||t>l||r<a||m>u)},g=[...o.value.engineObstacles.filter(d),...o.value.enginePortals.filter(d)];s.value=g,N.value=!1}else(X||F)&&U();Z=!1,X=!1,F=!1,b=""},Pe=e=>{if(e.ctrlKey){e.preventDefault();const l=e.deltaY>0?.9:1.1;f.value=Math.max(.1,Math.min(5,f.value*l))}else c.value=Math.max(0,c.value+e.deltaY)},_e=(e,l)=>{for(const a of o.value.engineObstacles)if(e>=a.x&&e<=a.x+a.width&&l>=a.y&&l<=a.y+a.height)return a;for(const a of o.value.enginePortals)if(e>=a.x&&e<=a.x+a.width&&l>=a.y&&l<=a.y+a.height)return a;return null},Ce=(e,l)=>{const a=W.value;if(z.includes(a)){const u={x:e,y:l-25,width:50,height:50,type:a,angle:0,initialY:l-25,movement:{type:"none",range:0,speed:0,phase:0}};o.value.engineObstacles.push(u),s.value=[u]}else{const u={x:e,y:l-30,width:60,height:80,type:a,angle:0,activated:!1};o.value.enginePortals.push(u),s.value=[u]}},H=()=>{s.value.length!==0&&(o.value.engineObstacles=o.value.engineObstacles.filter(e=>!s.value.includes(e)),o.value.enginePortals=o.value.enginePortals.filter(e=>!s.value.includes(e)),s.value=[],U())},Q=()=>{G.value=o.value.duration*350+500},Ie=()=>ae.value?.click(),Ae=e=>{const l=e.target.files?.[0];if(!l)return;const a=new FileReader;a.onload=u=>{o.value.audioData=u.target?.result,o.value.audioUrl=`/audio/${l.name}`,(!o.value.title||o.value.title==="NEW UNTITLED MAP")&&(o.value.title=l.name.split(".")[0]),confirm("Would you like to auto-generate and verify a map for this song?")&&(sessionStorage.setItem("umm_load_map",JSON.stringify(o.value)),sessionStorage.setItem("umm_smart_gen","true"),J.push("/play"))},a.readAsDataURL(l)},De=async()=>{const e=new ve;e.obstacles=[...o.value.engineObstacles],e.portals=[...o.value.enginePortals],e.totalLength=G.value;const l=await e.computeAutoplayLogAsync(200,360,()=>{});o.value.autoplayLog=e.autoplayLog,!(!l&&!confirm("AI cannot finish this map! Play anyway?"))&&(sessionStorage.setItem("umm_edit_map",JSON.stringify(o.value)),sessionStorage.setItem("umm_is_test","true"),sessionStorage.setItem("umm_load_map",JSON.stringify(o.value)),J.push("/play"))},Le=async()=>{try{const e=!o.value._id,l=e?"/api/maps":`/api/maps/${o.value._id}`,a=e?"POST":"PATCH";e&&(o.value.creatorName=le.value?.username||"Guest");const u=o.value.audioData;if(u&&u.length>he){const d=Fe(u,he),g={...o.value,audioData:null,audioChunks:[]},t=(await $fetch(l,{method:a,body:g}))._id;e&&(o.value._id=t);for(let i=0;i<d.length;i++)await $fetch(`/api/maps/${t}/audio-chunk`,{method:"POST",body:{chunkIndex:i,chunkData:d[i],totalChunks:d.length}});alert(`Map saved! (Audio: ${d.length} chunks)`)}else{const d=await $fetch(l,{method:a,body:o.value});e&&(o.value._id=d._id),alert("Map saved successfully!")}}catch(e){console.error("Save error:",e),alert(`Failed to save map: ${e.message||"Unknown error"}`)}};let oe;const ue=()=>{if(!w.value)return;const e=w.value.getContext("2d");if(!e)return;const l=w.value.width,a=w.value.height,u=performance.now()/1e3;e.clearRect(0,0,l,a),e.fillStyle="#050510",e.fillRect(0,0,l,a),e.save(),e.scale(f.value,f.value),e.translate(-c.value,0),e.strokeStyle="rgba(255, 255, 255, 0.05)";const d=50,g=Math.floor(c.value/d)*d;for(let t=g;t<c.value+l/f.value;t+=d)e.beginPath(),e.moveTo(t,0),e.lineTo(t,a/f.value),e.stroke();for(let t=0;t<a/f.value;t+=d)e.beginPath(),e.moveTo(c.value,t),e.lineTo(c.value+l/f.value,t),e.stroke();e.fillStyle="rgba(255, 0, 0, 0.1)",e.fillRect(c.value,0,l/f.value,140),e.fillRect(c.value,580,l/f.value,a/f.value-580),e.strokeStyle="#ff3333",e.lineWidth=3,e.beginPath(),e.moveTo(c.value,140),e.lineTo(c.value+l/f.value,140),e.stroke(),e.beginPath(),e.moveTo(c.value,580),e.lineTo(c.value+l/f.value,580),e.stroke(),e.fillStyle="#ff3333",e.font="bold 12px Outfit",e.fillText("CEILING BOUNDARY",c.value+10,130),e.fillText("FLOOR BOUNDARY",c.value+10,575),o.value.enginePortals.forEach(t=>{const i=V.getPortalColor(t.type);e.save(),t.angle&&(e.translate(t.x+t.width/2,t.y+t.height/2),e.rotate(t.angle*Math.PI/180),e.translate(-(t.x+t.width/2),-(t.y+t.height/2))),e.fillStyle=i,e.shadowBlur=15,e.shadowColor=i,e.globalAlpha=.2,e.fillRect(t.x,t.y,t.width,t.height),e.globalAlpha=1,e.strokeStyle="#fff",e.lineWidth=2,e.strokeRect(t.x,t.y,t.width,t.height),e.fillStyle="#fff",e.font="bold 20px Outfit",e.textAlign="center",e.fillText(V.getPortalSymbol(t.type),t.x+t.width/2,t.y+t.height/2+8),e.restore(),s.value.includes(t)&&(e.strokeStyle="#00ffff",e.lineWidth=3,e.strokeRect(t.x-5,t.y-5,t.width+10,t.height+10)),Y.value&&(e.strokeStyle="#00ff00",e.lineWidth=1,e.setLineDash([4,4]),e.strokeRect(t.x,t.y,t.width,t.height),e.setLineDash([]))}),o.value.engineObstacles.forEach(t=>{e.save(),t.angle!==void 0&&t.angle!==0&&(e.translate(t.x+t.width/2,t.y+t.height/2),e.rotate(t.angle*Math.PI/180),e.translate(-(t.x+t.width/2),-(t.y+t.height/2))),t.movement&&t.movement.type==="updown"&&(e.strokeStyle="rgba(0, 255, 255, 0.1)",e.beginPath(),e.moveTo(t.x+t.width/2,(t.initialY||t.y)-t.movement.range),e.lineTo(t.x+t.width/2,(t.initialY||t.y)+t.movement.range),e.stroke());const m=V.getObstacleStateAt(t,u),r=t.x,v=m.y;if(m.angle,t.type==="spike"||t.type==="mini_spike")e.fillStyle="#ff4d4d",e.shadowBlur=10,e.shadowColor="#ff0000",e.beginPath(),v>300?(e.moveTo(r,v+t.height),e.lineTo(r+t.width/2,v),e.lineTo(r+t.width,v+t.height)):(e.moveTo(r,v),e.lineTo(r+t.width/2,v+t.height),e.lineTo(r+t.width,v)),e.closePath(),e.fill();else if(t.type==="block")e.fillStyle="#444",e.shadowBlur=5,e.shadowColor="#666",e.fillRect(r,v,t.width,t.height),e.fillStyle="#555",e.fillRect(r+2,v+2,t.width-4,t.height-4);else if(t.type==="slope")e.fillStyle="#222",e.shadowBlur=15,e.shadowColor="#000",e.beginPath(),t.angle>0?(e.moveTo(r,v+t.height),e.lineTo(r+t.width,v),e.lineTo(r,v)):(e.moveTo(r+t.width,v+t.height),e.lineTo(r,v),e.lineTo(r+t.width,v)),e.closePath(),e.fill(),e.strokeStyle="rgba(100,200,255,0.3)",e.lineWidth=3,e.stroke();else if(t.type==="saw"){const P=r+t.width/2,_=v+t.height/2;e.save(),e.translate(P,_),e.scale(t.width/2,t.height/2),e.fillStyle="#ffaa00",e.shadowBlur=40/Math.max(t.width,t.height)*10,e.shadowColor="#ffaa00",e.beginPath(),e.arc(0,0,1,0,Math.PI*2),e.fill(),e.fillStyle="#ff6600";const k=10,S=u*8;for(let C=0;C<k;C++){const D=Math.PI*2*C/k+S;e.beginPath();const Re=Math.cos(D)*.75,Ne=Math.sin(D)*.75;e.arc(Re,Ne,.15,0,Math.PI*2),e.fill()}e.restore()}else if(t.type==="spike_ball"){const P=r+t.width/2,_=v+t.height/2,k=u*3;e.save(),e.translate(P,_),e.scale(t.width/2,t.height/2),e.fillStyle="#444";for(let C=0;C<8;C++){const D=Math.PI*2*C/8+k;e.beginPath(),e.moveTo(Math.cos(D-.2)*.8,Math.sin(D-.2)*.8),e.lineTo(Math.cos(D)*1.2,Math.sin(D)*1.2),e.lineTo(Math.cos(D+.2)*.8,Math.sin(D+.2)*.8),e.fill()}const S=e.createRadialGradient(-.3,-.3,.1,0,0,1);S.addColorStop(0,"#888"),S.addColorStop(1,"#222"),e.fillStyle=S,e.beginPath(),e.arc(0,0,.8,0,Math.PI*2),e.fill(),e.restore()}else if(t.type==="laser"||t.type==="v_laser"){const P=t.type==="v_laser",_=Math.sin(u*15)*5+10;e.strokeStyle="#ff3333",e.lineWidth=2,e.shadowBlur=Math.max(0,_),e.shadowColor="#ff0000",e.beginPath(),P?(e.moveTo(r+t.width/2,v),e.lineTo(r+t.width/2,v+t.height)):(e.moveTo(r,v+t.height/2),e.lineTo(r+t.width,v+t.height/2)),e.stroke(),e.strokeStyle="#fff",e.lineWidth=1,e.shadowBlur=0,e.stroke()}else if(t.type==="mine"){const P=r+t.width/2,_=v+t.height/2;e.save(),e.translate(P,_),e.scale(t.width/2,t.height/2);const k=Math.sin(u*10)*.1+.9;e.fillStyle="#ff3333",e.shadowBlur=10/Math.max(1,(t.width+t.height)/100),e.shadowColor="#ff0000",e.beginPath();for(let S=0;S<6;S++){const C=Math.PI/3*S+u*2;e.lineTo(Math.cos(C)*k,Math.sin(C)*k)}e.closePath(),e.fill(),e.restore()}else if(t.type==="orb"){const P=r+t.width/2,_=v+t.height/2;e.save(),e.translate(P,_),e.scale(t.width/2,t.height/2);const k=Math.sin(u*5)*.1+1,S=e.createRadialGradient(0,0,k*.1,0,0,k);S.addColorStop(0,"#fff"),S.addColorStop(.4,"#aa44ff"),S.addColorStop(1,"rgba(68,0,204,0)"),e.fillStyle=S,e.globalCompositeOperation="lighter",e.beginPath(),e.arc(0,0,k,0,Math.PI*2),e.fill(),e.globalCompositeOperation="source-over",e.restore()}Y.value&&(e.strokeStyle="#00ff00",e.lineWidth=1,e.setLineDash([4,4]),e.strokeRect(r,v,t.width,t.height),e.setLineDash([])),e.restore()});const h=G.value;if(e.strokeStyle="#00ff88",e.lineWidth=8,e.setLineDash([15,10]),e.beginPath(),e.moveTo(h,0),e.lineTo(h,a/f.value),e.stroke(),e.setLineDash([]),e.fillStyle="#00ff88",e.font="900 32px Outfit",e.textAlign="center",e.fillText("FINISH LINE",h,100),e.textAlign="left",s.value.forEach(t=>{if(e.save(),e.strokeStyle="#00ffff",e.lineWidth=2,e.setLineDash([5,5]),e.strokeRect(t.x,t.y,t.width,t.height),e.setLineDash([]),s.value.length===1){e.fillStyle="#fff";const i=6/f.value;e.fillRect(t.x-i,t.y-i,i*2,i*2),e.fillRect(t.x+t.width-i,t.y-i,i*2,i*2),e.fillRect(t.x-i,t.y+t.height-i,i*2,i*2),e.fillRect(t.x+t.width-i,t.y+t.height-i,i*2,i*2)}e.restore()}),N.value){e.fillStyle="rgba(0, 255, 255, 0.1)",e.strokeStyle="#00ffff",e.lineWidth=1;const t=Math.min(y.value.x1,y.value.x2),i=Math.min(y.value.y1,y.value.y2),m=Math.abs(y.value.x2-y.value.x1),r=Math.abs(y.value.y2-y.value.y1);e.fillRect(t,i,m,r),e.strokeRect(t,i,m,r)}e.restore(),oe=requestAnimationFrame(ue)},re=e=>{s.value.forEach(l=>{"angle"in l&&(l.angle=(l.angle||0)+e,l.angle<0&&(l.angle+=360),l.angle>=360&&(l.angle-=360))}),U()};return Be(()=>{const e=sessionStorage.getItem("umm_edit_map");e&&(o.value=JSON.parse(e),sessionStorage.removeItem("umm_edit_map"),Q()),U(),ue();const l=u=>{if(!(u.target instanceof HTMLInputElement||u.target instanceof HTMLTextAreaElement||u.target instanceof HTMLSelectElement))if(u.key==="Shift"&&(L.value=!0),u.ctrlKey||u.metaKey)if(u.key==="c")s.value.length>0&&(R.value=s.value.map(d=>({...d,_id:void 0})));else if(u.key==="x")s.value.length>0&&(R.value=s.value.map(d=>({...d,_id:void 0})),H());else if(u.key==="v"){if(R.value.length>0){const d=Math.min(...R.value.map(h=>h.x));Math.min(...R.value.map(h=>h.y));const g=R.value.map(h=>{const t={...h,x:c.value+(h.x-d)+100,y:h.y};return z.includes(t.type)?o.value.engineObstacles.push(t):o.value.enginePortals.push(t),t});s.value=g,U()}}else u.key==="z"?Me():u.key==="y"&&Te();else(u.key==="Delete"||u.key==="Backspace")&&s.value.length>0&&H()},a=u=>{u.key==="Shift"&&(L.value=!1)};window.addEventListener("keydown",l),window.addEventListener("keyup",a),Ve(()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",a),cancelAnimationFrame(oe)})}),(e,l)=>(O(),E("div",$e,[l[47]||(l[47]=n("div",{class:"background-anim"},null,-1)),n("header",Je,[n("div",ze,[l[22]||(l[22]=n("h1",{class:"title"},[$("MAP_ARCHITECT "),n("span",{class:"version"},"v2.0")],-1)),n("div",Ke,[x(n("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>o.value.title=a),placeholder:"Map Title",class:"map-title-input"},null,512),[[M,o.value.title]]),n("span",Ze,"BY: "+T(de(le)?.username||"Guest"),1)])]),n("div",qe,[n("div",Qe,[n("button",{onClick:De,class:"control-btn test"},[...l[23]||(l[23]=[n("span",{class:"icon"},"â–¶",-1),$(" TEST ",-1)])]),n("button",{onClick:Le,class:"control-btn save"},[...l[24]||(l[24]=[n("span",{class:"icon"},"ðŸ’¾",-1),$(" SAVE ",-1)])]),n("button",{onClick:l[1]||(l[1]=a=>Y.value=!Y.value),class:j(["control-btn",{active:Y.value}])},[...l[25]||(l[25]=[n("span",{class:"icon"},"â›¶",-1),$(" HITBOX ",-1)])],2),n("button",{onClick:l[2]||(l[2]=a=>de(J).push("/maps")),class:"control-btn exit"},"EXIT")])]),n("div",je,[n("div",et,[n("span",tt,"OBJ: "+T(o.value.engineObstacles.length),1),n("span",lt,"PORT: "+T(o.value.enginePortals.length),1)])])]),n("div",at,[n("aside",nt,[l[27]||(l[27]=n("h3",null,"PALETTE",-1)),n("div",it,[(O(),E(ee,null,te(z,a=>n("div",{key:a,class:j(["palette-item",{selected:W.value===a}]),onClick:u=>W.value=a},[n("div",ot,T(ge(a)),1),n("span",ut,T(a.split("_").join(" ").toUpperCase()),1)],10,st)),64)),l[26]||(l[26]=n("div",{class:"separator"},"PORTALS",-1)),(O(),E(ee,null,te(fe,a=>n("div",{key:a,class:j(["palette-item portal",{selected:W.value===a}]),onClick:u=>W.value=a},[n("div",dt,T(me(a)),1),n("span",vt,T(a.split("_").join(" ").toUpperCase()),1)],10,rt)),64))])]),n("main",{class:"workspace glass-panel",ref_key:"workspaceRef",ref:ce,onMousedown:Se,onMousemove:Ee,onMouseup:Oe,onWheel:Pe,onContextmenu:l[4]||(l[4]=We(()=>{},["prevent"]))},[n("canvas",{ref_key:"canvasRef",ref:w,width:"1200",height:"600",class:"editor-canvas"},null,512),n("div",ht,[n("span",null,"ZOOM: "+T((f.value*100).toFixed(0))+"%",1),n("span",null,"X: "+T(Math.floor(c.value)),1)]),n("div",ct,[x(n("input",{type:"range",min:"0",max:G.value,"onUpdate:modelValue":l[3]||(l[3]=a=>c.value=a),class:"timeline-slider"},null,8,ft),[[M,c.value,void 0,{number:!0}]])])],544),n("aside",gt,[l[45]||(l[45]=n("h3",null,"PROPERTIES",-1)),s.value.length===1?(O(),E("div",mt,[n("div",pt,[l[28]||(l[28]=n("label",null,"TYPE",-1)),n("span",yt,T(s.value[0].type.toUpperCase()),1)]),n("div",wt,[l[29]||(l[29]=n("label",null,"POSITION X / Y",-1)),n("div",xt,[x(n("input",{type:"number","onUpdate:modelValue":l[5]||(l[5]=a=>s.value[0].x=a)},null,512),[[M,s.value[0].x,void 0,{number:!0}]]),x(n("input",{type:"number","onUpdate:modelValue":l[6]||(l[6]=a=>s.value[0].y=a)},null,512),[[M,s.value[0].y,void 0,{number:!0}]])])]),n("div",Mt,[l[30]||(l[30]=n("label",null,"SIZE W / H",-1)),n("div",Tt,[x(n("input",{type:"number","onUpdate:modelValue":l[7]||(l[7]=a=>s.value[0].width=a)},null,512),[[M,s.value[0].width,void 0,{number:!0}]]),x(n("input",{type:"number","onUpdate:modelValue":l[8]||(l[8]=a=>s.value[0].height=a)},null,512),[[M,s.value[0].height,void 0,{number:!0}]])])]),"type"in s.value[0]?(O(),E("div",kt,[l[31]||(l[31]=n("label",null,"ROTATION (DEG)",-1)),n("div",St,[n("button",{onClick:l[9]||(l[9]=a=>re(-45)),class:"rot-btn"},"â†º -45Â°"),n("button",{onClick:l[10]||(l[10]=a=>re(45)),class:"rot-btn"},"45Â° â†»")]),x(n("input",{type:"number","onUpdate:modelValue":l[11]||(l[11]=a=>s.value[0].angle=a)},null,512),[[M,s.value[0].angle,void 0,{number:!0}]]),x(n("input",{type:"range",min:"0",max:"360","onUpdate:modelValue":l[12]||(l[12]=a=>s.value[0].angle=a)},null,512),[[M,s.value[0].angle,void 0,{number:!0}]])])):B("",!0),"movement"in s.value[0]?(O(),E("div",Et,[l[36]||(l[36]=n("label",null,"MOVEMENT",-1)),s.value[0].movement?x((O(),E("select",{key:0,"onUpdate:modelValue":l[13]||(l[13]=a=>s.value[0].movement.type=a)},[...l[32]||(l[32]=[n("option",{value:"none"},"NONE",-1),n("option",{value:"updown"},"UP-DOWN BOUNCE",-1),n("option",{value:"rotate"},"CONTINUOUS ROTATE",-1)])],512)),[[Ye,s.value[0].movement.type]]):B("",!0),s.value[0].movement&&s.value[0].movement.type!=="none"?(O(),E("div",Ot,[l[33]||(l[33]=n("label",null,"SPEED",-1)),x(n("input",{type:"number",step:"0.1","onUpdate:modelValue":l[14]||(l[14]=a=>s.value[0].movement.speed=a)},null,512),[[M,s.value[0].movement.speed,void 0,{number:!0}]]),l[34]||(l[34]=n("label",null,"RANGE",-1)),x(n("input",{type:"number","onUpdate:modelValue":l[15]||(l[15]=a=>s.value[0].movement.range=a)},null,512),[[M,s.value[0].movement.range,void 0,{number:!0}]]),l[35]||(l[35]=n("label",null,"PHASE OFFSET",-1)),x(n("input",{type:"number",step:"0.1","onUpdate:modelValue":l[16]||(l[16]=a=>s.value[0].movement.phase=a)},null,512),[[M,s.value[0].movement.phase,void 0,{number:!0}]])])):B("",!0)])):B("",!0),n("button",{onClick:H,class:"delete-btn"},"DELETE OBJECT")])):s.value.length>1?(O(),E("div",Pt,[n("div",_t,[l[37]||(l[37]=n("label",null,"MULTIPLE SELECTION",-1)),n("span",Ct,T(s.value.length)+" OBJECTS",1)]),n("button",{onClick:H,class:"delete-btn"},"DELETE ALL")])):(O(),E("div",It," SELECT OBJECTS TO MODIFY ")),n("div",At,[l[38]||(l[38]=n("h3",null,"LEVEL CONFIG",-1)),l[39]||(l[39]=n("label",null,"TOTAL DURATION (S)",-1)),x(n("input",{type:"number","onUpdate:modelValue":l[17]||(l[17]=a=>o.value.duration=a),onChange:Q},null,544),[[M,o.value.duration,void 0,{number:!0}]]),l[40]||(l[40]=n("label",null,"DIFFICULTY",-1)),x(n("input",{type:"number","onUpdate:modelValue":l[18]||(l[18]=a=>o.value.difficulty=a)},null,512),[[M,o.value.difficulty,void 0,{number:!0}]])]),n("div",Dt,[l[42]||(l[42]=n("h3",null,"AUDIO CONFIG",-1)),l[43]||(l[43]=n("label",null,"BPM",-1)),x(n("input",{type:"number","onUpdate:modelValue":l[19]||(l[19]=a=>o.value.bpm=a)},null,512),[[M,o.value.bpm,void 0,{number:!0}]]),l[44]||(l[44]=n("label",null,"MEASURE LENGTH (S)",-1)),x(n("input",{type:"number",step:"0.1","onUpdate:modelValue":l[20]||(l[20]=a=>o.value.measureLength=a)},null,512),[[M,o.value.measureLength,void 0,{number:!0}]]),n("div",Lt,[l[41]||(l[41]=n("label",null,"AUDIO FILE",-1)),n("button",{onClick:Ie,class:"upload-btn"},T(o.value.audioData?"AUDIO LOADED":"UPLOAD MP3"),1),n("input",{type:"file",ref_key:"audioInputRef",ref:ae,accept:"audio/*",style:{display:"none"},onChange:Ae},null,544),o.value.audioData?(O(),E("p",Rt,"Audio embedded in map data")):B("",!0)])])])]),ne.value?(O(),E("div",Nt,[n("div",Ut,[l[46]||(l[46]=n("h2",null,"SMART MAP GENERATION",-1)),n("div",bt,[n("div",Bt,[n("div",{class:"fill",style:Ge({width:K.value+"%"})},null,4)]),n("span",Vt,T(xe(ye.value))+" ("+T(K.value.toFixed(0))+"%)",1)]),n("div",Wt,[(O(!0),E(ee,null,te(pe.value,(a,u)=>(O(),E("div",{key:u,class:"log-line"},T(a),1))),128))]),n("div",Yt,[n("button",{onClick:l[21]||(l[21]=a=>ne.value=!1),disabled:we.value&&K.value<100,class:"control-btn exit"},"CLOSE",8,Gt)])])])):B("",!0)]))}}),Zt=He(Xt,[["__scopeId","data-v-6a20ed98"]]);export{Zt as default};
