import{e as Me,r as k,h as me,j as xe,i as he,c as E,o as I,a as t,k as J,n as de,F as _e,l as Ae,t as j,s as we,d as K,x as Oe,f as Ue,y as Le,b as Ge,m as be,p as qe,v as ze,z as je,g as Ve,A as Ye}from"./OCD2nr9N.js";import{_ as ke}from"./DlAUqK2U.js";import{_ as We}from"./CDLXmStr.js";import{G as Se}from"./DP0Q2vyH.js";import{t as He,M as Xe,s as Je,C as Ke}from"./CUbsk6PR.js";import{s as Ze}from"./C92kQu4n.js";const Qe="ImpossibleTimingDB",te="recent_songs",et=2,Re=20,tt=()=>{const Y=()=>new Promise((D,p)=>{const u=indexedDB.open(Qe,et);u.onerror=()=>p("IndexedDB error"),u.onupgradeneeded=s=>{const v=s.target.result;if(!v.objectStoreNames.contains(te)){const A=v.createObjectStore(te,{keyPath:"id"});A.createIndex("name","name",{unique:!1}),A.createIndex("addedAt","addedAt",{unique:!1})}v.objectStoreNames.contains("songs")||v.createObjectStore("songs",{keyPath:"id"})},u.onsuccess=s=>{D(s.target.result)}});return{addSong:async D=>{const p=await Y();return new Promise(async(u,s)=>{try{const A=p.transaction([te],"readwrite").objectStore(te),b=A.index("name").getAll(D.name);b.onsuccess=async()=>{const P=b.result;for(const r of P)A.delete(r.id);const m={id:crypto.randomUUID(),name:D.name,blob:D,addedAt:Date.now()};A.add(m);const g=A.index("addedAt").getAll();g.onsuccess=()=>{const r=g.result;if(r.length>Re){const i=r.sort((L,N)=>L.addedAt-N.addedAt).slice(0,r.length-Re);for(const L of i)A.delete(L.id)}},u(m)},b.onerror=()=>s("Error checking duplicates")}catch(v){s(v)}})},getSongs:async()=>{const D=await Y();return new Promise((p,u)=>{const A=D.transaction([te],"readonly").objectStore(te).getAll();A.onsuccess=()=>{const w=A.result.sort((b,P)=>P.addedAt-b.addedAt);p(w)},A.onerror=()=>u("Error fetching songs")})},deleteSong:async D=>{const p=await Y();return new Promise((u,s)=>{const w=p.transaction([te],"readwrite").objectStore(te).delete(D);w.onsuccess=()=>u(),w.onerror=()=>s("Error deleting song")})},clearAll:async()=>{const D=await Y();return new Promise((p,u)=>{const A=D.transaction([te],"readwrite").objectStore(te).clear();A.onsuccess=()=>p(),A.onerror=()=>u("Error clearing songs")})}}},at={class:"song-selector"},st={class:"tabs"},ot={key:0,class:"tab-content"},nt={class:"sample-list"},lt=["onClick"],it={class:"sample-info"},rt={class:"sample-name"},ut={class:"sample-meta"},ct={key:0,class:"loading-indicator"},dt={key:1,class:"tab-content"},ft={key:0},vt={key:1,class:"highlight"},pt={key:2,class:"tab-content"},mt={class:"youtube-guide"},gt={class:"guide-steps"},ht={class:"step"},yt={class:"step-content"},wt={key:3,class:"tab-content"},bt={key:0,class:"storage-list"},St=["onClick"],_t={class:"song-info"},At={class:"name"},Mt={class:"date"},xt=["onClick"],kt={key:1,class:"empty-state"},Dt=["disabled"],Tt=Me({__name:"SongSelector",emits:["select"],setup(Y,{emit:B}){const y=B,c=k("samples"),S=k(null),D=k(null),p=k(null),{addSong:u,getSongs:s,deleteSong:v,clearAll:A}=tt(),w=k([]),b=k(null),P=k([{id:"1",name:"God Chang-seop (ì‹ ì°½ì„­) 'ë°”ë¡œ ë¦¬ë¶€íŠ¸ ì •ìƒí™”' MV",genre:"K-Pop",duration:"3:36",url:"/audio/samples/God Chang-seop (ì‹ ì°½ì„­) 'ë°”ë¡œ ë¦¬ë¶€íŠ¸ ì •ìƒí™”' MV.mp3"},{id:"2",name:"I Love You",genre:"Pop",duration:"3:41",url:"/audio/samples/I Love You.mp3"},{id:"3",name:"Nyan Cat! [Official]",genre:"Electronic",duration:"3:37",url:"/audio/samples/Nyan Cat! [Official].mp3"}]),m=k(null),g=k(null),r=me(()=>c.value==="youtube"||g.value?!1:p.value||b.value||m.value);async function h(){try{w.value=await s()}catch(_){console.error("Failed to load recent songs:",_)}}function i(_){const n=new Date(_),q=new Date().getTime()-n.getTime(),re=Math.floor(q/6e4),H=Math.floor(q/36e5),ue=Math.floor(q/864e5);return re<1?"ë°©ê¸ˆ ì „":re<60?`${re}ë¶„ ì „`:H<24?`${H}ì‹œê°„ ì „`:ue<7?`${ue}ì¼ ì „`:n.toLocaleDateString()}async function L(_){m.value=_,b.value=null,p.value=null,g.value=_.id;try{const n=await fetch(_.url);if(!n.ok)throw new Error("Failed to load sample");const C=await n.blob(),q=new File([C],_.name+".mp3",{type:"audio/mpeg"});p.value=q,S.value=q}catch(n){console.error("Failed to load sample:",n),m.value=null}finally{g.value=null}}function N(_){b.value=_,p.value=null,m.value=null}async function F(_){try{await v(_),await h(),b.value?.id===_&&(b.value=null)}catch(n){console.error("Failed to delete song:",n)}}async function ie(){if(Q())try{await A(),w.value=[],b.value=null}catch(_){console.error("Failed to clear songs:",_)}}xe(h),he(c,_=>{_==="storage"&&h()});function G(){D.value?.click()}function Z(_){const n=_.target;n.files?.[0]&&V(n.files[0])}function ne(_){_.dataTransfer?.files?.[0]&&V(_.dataTransfer.files[0])}async function V(_){S.value=_,p.value=_,b.value=null,m.value=null;try{await u(_)}catch(n){console.error("Failed to save to recent songs:",n)}}async function Q(){if(c.value==="storage"&&b.value){const _=new File([b.value.blob],b.value.name,{type:b.value.blob.type||"audio/mpeg"});y("select",_)}else p.value&&y("select",p.value)}return(_,n)=>(I(),E("div",at,[t("div",st,[t("button",{class:de({active:c.value==="samples"}),onClick:n[0]||(n[0]=C=>c.value="samples")},"SAMPLES",2),t("button",{class:de({active:c.value==="upload"}),onClick:n[1]||(n[1]=C=>c.value="upload")},"UPLOAD",2),t("button",{class:de({active:c.value==="youtube"}),onClick:n[2]||(n[2]=C=>c.value="youtube")},"GUIDE",2),t("button",{class:de({active:c.value==="storage"}),onClick:n[3]||(n[3]=C=>c.value="storage")},"RECENT",2)]),c.value==="samples"?(I(),E("div",ot,[n[6]||(n[6]=t("p",{class:"section-desc"},"CC0 ë¬´ë£Œ ìŒì•… - ì €ì‘ê¶Œ ê±±ì • ì—†ì´ ë°”ë¡œ í”Œë ˆì´!",-1)),t("div",nt,[(I(!0),E(_e,null,Ae(P.value,C=>(I(),E("div",{key:C.id,class:de(["sample-item",{selected:m.value?.id===C.id,loading:g.value===C.id}]),onClick:q=>L(C)},[t("div",it,[t("span",rt,j(C.name),1),t("span",ut,j(C.genre)+" â€¢ "+j(C.duration),1)]),g.value===C.id?(I(),E("span",ct,"â—†")):J("",!0)],10,lt))),128))])])):c.value==="upload"?(I(),E("div",dt,[t("div",{class:"drop-zone",onDragover:n[4]||(n[4]=we(()=>{},["prevent"])),onDrop:we(ne,["prevent"]),onClick:G},[S.value?(I(),E("p",vt,j(S.value.name),1)):(I(),E("p",ft,"DROP FILE HERE"))],32),t("input",{type:"file",ref_key:"fileInput",ref:D,accept:"audio/*",style:{display:"none"},onChange:Z},null,544)])):c.value==="youtube"?(I(),E("div",pt,[t("div",mt,[n[11]||(n[11]=t("h3",{class:"guide-title"},"ğŸµ YouTube MP3 ë³€í™˜ ê°€ì´ë“œ",-1)),n[12]||(n[12]=t("p",{class:"guide-desc"},[K("ì €ì‘ê¶Œ ë³´í˜¸ë¥¼ ìœ„í•´ ì§ì ‘ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤."),t("br"),K("ì•„ë˜ ë°©ë²•ìœ¼ë¡œ MP3 íŒŒì¼ì„ ì¤€ë¹„í•´ì£¼ì„¸ìš”.")],-1)),t("div",gt,[n[10]||(n[10]=Oe('<div class="step" data-v-3347f0dd><span class="step-num" data-v-3347f0dd>1</span><div class="step-content" data-v-3347f0dd><strong data-v-3347f0dd>YouTube ì˜ìƒ URL ë³µì‚¬</strong><p data-v-3347f0dd>ì›í•˜ëŠ” ìŒì•… ì˜ìƒì˜ ì£¼ì†Œë¥¼ ë³µì‚¬í•˜ì„¸ìš”</p></div></div><div class="step" data-v-3347f0dd><span class="step-num" data-v-3347f0dd>2</span><div class="step-content" data-v-3347f0dd><strong data-v-3347f0dd>MP3 ë³€í™˜ ì‚¬ì´íŠ¸ ì´ìš©</strong><p data-v-3347f0dd>ì•„ë˜ ì‚¬ì´íŠ¸ì—ì„œ MP3ë¡œ ë³€í™˜í•˜ì„¸ìš”</p><div class="converter-links" data-v-3347f0dd><a href="https://y2mate.com" target="_blank" rel="noopener" class="converter-link" data-v-3347f0dd><span class="link-icon" data-v-3347f0dd>ğŸ”—</span> Y2Mate </a><a href="https://ytmp3.cc" target="_blank" rel="noopener" class="converter-link" data-v-3347f0dd><span class="link-icon" data-v-3347f0dd>ğŸ”—</span> YTMP3 </a><a href="https://loader.to" target="_blank" rel="noopener" class="converter-link" data-v-3347f0dd><span class="link-icon" data-v-3347f0dd>ğŸ”—</span> Loader.to </a></div></div></div>',2)),t("div",ht,[n[9]||(n[9]=t("span",{class:"step-num"},"3",-1)),t("div",yt,[n[7]||(n[7]=t("strong",null,"MP3 íŒŒì¼ ì—…ë¡œë“œ",-1)),n[8]||(n[8]=t("p",null,"ë‹¤ìš´ë¡œë“œí•œ MP3 íŒŒì¼ì„ UPLOAD íƒ­ì—ì„œ ì—…ë¡œë“œí•˜ì„¸ìš”",-1)),t("button",{class:"go-upload-btn",onClick:n[5]||(n[5]=C=>c.value="upload")},"UPLOAD íƒ­ìœ¼ë¡œ ì´ë™ â†’")])])]),n[13]||(n[13]=t("div",{class:"warning-box"},[t("span",{class:"warning-icon"},"âš ï¸"),t("p",null,[K("ì´ìƒí•œ ìŠ¤íŒ¸ ì‚¬ì´íŠ¸ê°€ ë‚˜ì˜¬ ìˆ˜ë„ ìˆìœ¼ë‹ˆ ìë™ìœ¼ë¡œ ì—´ë¦¬ëŠ” ì‚¬ì´íŠ¸ëŠ” ë°”ë¡œ ë‹«ì•„ì£¼ì„¸ìš”."),t("br"),K("2ë²ˆì •ë„ ë‹«ìœ¼ë©´ ë‹¤ìš´ë¡œë“œê°€ ë©ë‹ˆë‹¤.")])],-1))])])):c.value==="storage"?(I(),E("div",wt,[n[15]||(n[15]=t("p",{class:"section-desc"},"ìµœê·¼ ì‚¬ìš©í•œ ë…¸ë˜ (ìµœëŒ€ 20ê³¡)",-1)),w.value.length>0?(I(),E("div",bt,[(I(!0),E(_e,null,Ae(w.value,C=>(I(),E("div",{key:C.id,class:de(["storage-item",{selected:b.value?.id===C.id}]),onClick:q=>N(C)},[t("div",_t,[t("span",At,j(C.name),1),t("span",Mt,j(i(C.addedAt)),1)]),t("button",{class:"delete-btn",onClick:we(q=>F(C.id),["stop"])},"âœ•",8,xt)],10,St))),128))])):(I(),E("div",kt,[...n[14]||(n[14]=[t("p",{class:"empty-icon"},"ğŸ“",-1),t("p",{class:"empty-msg"},"ìµœê·¼ ì‚¬ìš©í•œ ë…¸ë˜ê°€ ì—†ìŠµë‹ˆë‹¤",-1),t("p",{class:"empty-hint"},"UPLOAD íƒ­ì—ì„œ ë…¸ë˜ë¥¼ ì¶”ê°€í•˜ë©´ ì—¬ê¸°ì— ê¸°ë¡ë©ë‹ˆë‹¤",-1)])])),w.value.length>0?(I(),E("button",{key:2,class:"clear-all-btn",onClick:ie}," ì „ì²´ ì‚­ì œ ")):J("",!0)])):J("",!0),t("button",{class:"confirm-btn",disabled:!r.value,onClick:Q}," SELECT ",8,Dt)]))}}),It=Object.assign(ke(Tt,[["__scopeId","data-v-3347f0dd"]]),{__name:"SongSelector"}),Ct=()=>{const Y=k(null);return{analyzeAudio:async(y,c,S)=>{S&&S({step:"ì˜¤ë””ì˜¤ í—¤ë”ë¥¼ ì½ëŠ” ì¤‘...",percent:5}),Y.value||(Y.value=new(window.AudioContext||window.webkitAudioContext));const D=await y.arrayBuffer();S&&S({step:"ì˜¤ë””ì˜¤ ë°ì´í„°ë¥¼ ë””ì½”ë”©í•˜ëŠ” ì¤‘...",percent:15});const p=await Y.value.decodeAudioData(D),u=p.getChannelData(0),s=p.sampleRate,v=Math.floor(s/150);S&&S({step:"ìµœê³  ìŒëŸ‰ì„ íŒŒì•…í•˜ê³  ìˆìŠµë‹ˆë‹¤...",percent:25});for(let o=0;o<u.length;o+=v)Math.abs(u[o]||0);const A=.35-(c-1)/29*.3;S&&S({step:"ë¹„íŠ¸ íŒ¨í„´ì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...",percent:35}),S&&S({step:"ë¹„íŠ¸ íŒ¨í„´ì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... (Energy Flux)",percent:35});const w=[];let b=0;const P=Math.floor(s*.05),m=Math.floor(s/100),g=[];let r=0;for(let o=0;o<Math.min(P,u.length);o++)r+=u[o]*u[o];for(let o=0;o<u.length-P;o+=m){const T=Math.sqrt(r/P);g.push({t:o/s,e:T});for(let R=0;R<m;R++){const O=u[o+R]||0,U=u[o+P+R]||0;r=r-O*O+U*U}r<0&&(r=0)}const h=[];for(let o=1;o<g.length;o++){const T=Math.max(0,g[o].e-g[o-1].e);h.push(T)}const i=[];for(let o=0;o<h.length;o++){const T=Math.max(0,o-100),R=Math.min(h.length,o+100);let O=0;for(let ee=T;ee<R;ee++)O+=h[ee];const U=O/(R-T);i.push(U)}const L=1.8-(c-1)/29*.4;for(let o=1;o<h.length-1;o++){const T=h[o],R=i[o],O=g[o].t,U=g[o].e;if(T>R*L&&U>.02&&T>h[o-1]&&T>h[o+1]&&O-b>A&&(w.push(O),b=O),S&&o%1e3===0){const ee=35+o/h.length*40;S({step:"ì •ë°€ ë¹„íŠ¸ ë¶„ì„ ì¤‘... (Adaptive)",percent:Math.floor(ee)})}}console.log(`[AudioAnalyzer] Adaptive Logic Detected ${w.length} beats`),S&&S({step:"ì¥ì• ë¬¼ì„ ìµœì  ë°°ì¹˜í•˜ê³  ìˆìŠµë‹ˆë‹¤...",percent:75});const N=[...w];if(N.length<10){console.log("Too few beats detected, adding fallback beats...");const o=.5;for(let T=0;T<p.duration;T+=o)N.push(T)}N.sort((o,T)=>o-T),S&&S({step:"BPMì„ ë¶„ì„í•˜ëŠ” ì¤‘...",percent:80});let F=120;if(w.length>=4){const o=[];for(let T=1;T<Math.min(w.length,50);T++){const R=w[T]-w[T-1];R>.2&&R<2&&o.push(R)}if(o.length>0){o.sort((O,U)=>O-U);const R=60/o[Math.floor(o.length/2)];F=Math.round(R/5)*5,F=Math.max(60,Math.min(200,F))}}const G=60/F*4;console.log(`[AudioAnalyzer] Detected BPM: ${F}, Measure Length: ${G.toFixed(3)}s`),S&&S({step:"ê³¡ì˜ ë¶„ìœ„ê¸° ë³€í™”ë¥¼ ê°ì§€í•˜ëŠ” ì¤‘...",percent:85});const Z=[],ne=s,V=[];for(let o=0;o<u.length;o+=ne){let T=0;const R=Math.min(u.length,o+ne);for(let O=o;O<R;O++){const U=u[O]??0;T+=U*U}V.push(Math.sqrt(T/(R-o||1)))}const Q=6;let _=0,n=V[0]||.001,C=0,q=0;for(let o=0;o<V.length;o++){const T=V[o]??0;C+=T,q++;const R=o-_,O=Math.abs(T-n)/n;if(R>=Q&&(O>.4||R>=15)){const U=C/q;Z.push({startTime:_,endTime:o,intensity:U}),_=o,C=0,q=0,n=U||.001}}if(_<V.length){const o=q>0?C/q:0;Z.push({startTime:_,endTime:p.duration,intensity:o})}const re=Math.max(...Z.map(o=>o.intensity),.001);Z.forEach(o=>{o.intensity=o.intensity/re}),S&&S({step:"ë³¼ë¥¨ì˜ íë¦„ì„ ë¶„ì„ ì¤‘...",percent:90});const H=[],ue=Math.floor(s/10);let fe=0;for(let o=0;o<u.length;o+=ue){const T=Math.min(u.length,o+ue);let R=0;for(let U=o;U<T;U++){const ee=u[U]||0;R+=ee*ee}const O=Math.sqrt(R/(T-o));H.push(O),O>fe&&(fe=O)}if(fe>0)for(let o=0;o<H.length;o++)H[o]=H[o]/fe;return S&&S({step:"ë§µ ìƒì„±ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!",percent:100}),{buffer:p,obstacles:N,sections:Z,duration:p.duration,bpm:F,measureLength:G,volumeProfile:H}}}},$t={class:"map-preview-modal-overlay"},Et={class:"map-preview-modal glass-panel"},Lt={class:"modal-header"},Rt={class:"preview-viewport"},Pt=["width"],Ot={class:"info-footer"},pe=.5,Pe=350,Bt=Me({__name:"MapPreviewModal",props:{mapData:{}},emits:["close"],setup(Y,{emit:B}){const y=Y,c=k(null),S=k(null),D=me(()=>y.mapData?.duration||60),p=me(()=>Math.ceil(D.value*Pe*pe)+500),u=()=>{if(!c.value||!y.mapData)return;const s=c.value.getContext("2d");if(!s)return;const v=c.value.width,A=c.value.height;s.fillStyle="#050510",s.fillRect(0,0,v,A),s.strokeStyle="rgba(255, 255, 255, 0.05)",s.lineWidth=1;const w=100*pe;for(let m=0;m<v;m+=w)s.beginPath(),s.moveTo(m,0),s.lineTo(m,A),s.stroke();for(let m=0;m<A;m+=40*pe)s.beginPath(),s.moveTo(0,m),s.lineTo(v,m),s.stroke();s.fillStyle="rgba(255, 0, 255, 0.1)",s.fillRect(0,0,v,140*pe),s.fillStyle="rgba(0, 255, 255, 0.1)";const b=pe,P=1;if(y.mapData.beatTimes&&(s.lineWidth=2,y.mapData.beatTimes.forEach(m=>{const g=m*Pe*b;s.strokeStyle="rgba(255, 255, 0, 0.3)",s.beginPath(),s.moveTo(g,0),s.lineTo(g,A),s.stroke(),s.fillStyle="#ffff00",s.fillRect(g-2,A-20,4,10)})),y.mapData.engineObstacles&&(s.fillStyle="#ff4444",s.strokeStyle="#fff",s.lineWidth=1,y.mapData.engineObstacles.forEach(m=>{const g=m.x*b,r=m.y*P,h=m.width*b,i=m.height*P;m.type==="spike"||m.type==="mini_spike"?(s.beginPath(),m.y>300?(s.moveTo(g,r+i),s.lineTo(g+h/2,r),s.lineTo(g+h,r+i)):(s.moveTo(g,r),s.lineTo(g+h/2,r+i),s.lineTo(g+h,r)),s.fill()):s.fillRect(g,r,h,i)})),y.mapData.autoplayLog&&y.mapData.autoplayLog.length>0){s.beginPath(),s.strokeStyle="#00ffff",s.lineWidth=4;let m=!0;y.mapData.autoplayLog.forEach(g=>{const r=g.x*b,h=g.y*P;m?(s.moveTo(r,h),m=!1):s.lineTo(r,h)}),s.stroke()}};return xe(()=>{u()}),he(()=>y.mapData,u),(s,v)=>(I(),E("div",$t,[t("div",Et,[t("div",Lt,[v[1]||(v[1]=Oe('<h2 data-v-2bb7f56e>MAP VISUALIZATION LOGIC</h2><div class="legend" data-v-2bb7f56e><span class="legend-item" data-v-2bb7f56e><span class="color-box note" data-v-2bb7f56e></span> Piano Notes (Beats)</span><span class="legend-item" data-v-2bb7f56e><span class="color-box path" data-v-2bb7f56e></span> Path (Trajectory)</span><span class="legend-item" data-v-2bb7f56e><span class="color-box obstacle" data-v-2bb7f56e></span> Obstacles</span></div>',2)),t("button",{class:"close-btn",onClick:v[0]||(v[0]=A=>s.$emit("close"))},"Ã—")]),t("div",Rt,[t("div",{class:"scroll-container",ref_key:"scrollContainer",ref:S},[t("canvas",{ref_key:"canvas",ref:c,width:p.value,height:720},null,8,Pt)],512)]),t("div",Ot,[t("p",null,"Total Duration: "+j(D.value.toFixed(1))+"s",1),t("p",null,"Total Length: "+j(p.value)+"px",1)])])]))}}),Nt=Object.assign(ke(Bt,[["__scopeId","data-v-2bb7f56e"]]),{__name:"MapPreviewModal"});class Ft{audioContext;constructor(){this.audioContext=new(window.AudioContext||window.webkitAudioContext)}async decodeAudio(B){return await this.audioContext.decodeAudioData(B)}async findOnsets(B,y=10){const c=B.getChannelData(0),S=B.sampleRate,D=Math.floor(S*.025),p=Math.floor(S*.005),u=[];let s=0;for(let r=0;r<Math.min(D,c.length);r++){const h=c[r]||0;s+=h*h}for(let r=0;r<c.length-D;r+=p){const h=Math.sqrt(s/D);u.push({t:r/S,e:h});for(let i=0;i<p;i++){const L=c[r+i]||0,N=c[r+D+i]||0;s=s-L*L+N*N}s<0&&(s=0)}const v=[];for(let r=1;r<u.length;r++){const h=u[r]?.e||0,i=u[r-1]?.e||0,L=Math.max(0,h-i);v.push(L)}const A=[];for(let r=0;r<v.length;r++){const h=Math.max(0,r-100),i=Math.min(v.length,r+100);let L=0;for(let F=h;F<i;F++)L+=v[F]||0;const N=L/(i-h);A.push(N)}const w=[],b=[],P=1.5,m=.1;let g=0;for(let r=1;r<v.length-1;r++){const h=v[r],i=v[r-1],L=v[r+1],N=A[r],F=u[r]?.t;h!==void 0&&i!==void 0&&L!==void 0&&N!==void 0&&F!==void 0&&h>N*P&&h>i&&h>L&&F-g>m&&(w.push(F),b.push(h),g=F)}return{times:w,peaks:b}}}class Ut{engine;analyzer;status="idle";progress=0;log=[];constructor(B){this.engine=B,this.analyzer=new Ft}setStatus(B,y,c){this.status=B,this.progress=y,c&&this.log.push(`[${B}] ${c}`)}async generate(B,y){try{this.setStatus("analyzing_song",10,"Decoding audio...");const c=await this.analyzer.decodeAudio(B);this.setStatus("analyzing_song",20,"Detecting volume spikes...");const D=(await this.analyzer.findOnsets(c,y.difficulty)).times;this.setStatus("analyzing_song",30,`Detected ${D.length} notes (spikes).`),this.setStatus("generating_path",30,"Initial path generation..."),await new Promise(v=>setTimeout(v,500));let p=0,u=0;const s=50;for(;p<.975&&u<s;){this.setStatus("adjusting_path",30+u/s*30,`Attempt ${u+1}: Simulating... Match: ${(p*100).toFixed(1)}%`),this.engine.generateMap(D,y.sections||[],c.duration,y.seed?y.seed+u:u,!0,u,y.bpm||120,y.measureLength||2);const v=this.engine.autoplayLog,A=this.calculateMatchRate(v,D);if(A>p&&(p=A),this.log.push(`Attempt ${u}: Match Rate ${(A*100).toFixed(2)}%`),p>=.975)break;u++,await new Promise(w=>setTimeout(w,10))}return p<.9?this.log.push(`Warning: Could not reach 97.5%. Best: ${(p*100).toFixed(2)}%`):this.log.push(`Success: Reached ${(p*100).toFixed(2)}% verify rate.`),this.setStatus("generating_map",70,"Finalizing map objects..."),this.setStatus("adjusting_map",80,"Optimizing obstacles..."),await new Promise(v=>setTimeout(v,200)),this.setStatus("saving_map",90,"Preparing map data..."),await new Promise(v=>setTimeout(v,200)),this.setStatus("completed",100,"Ready to save."),!0}catch(c){return this.setStatus("failed",0,`Error: ${c.message}`),console.error(c),!1}}calculateMatchRate(B,y){if(!B||B.length===0||y.length===0)return 0;const c=[];let S=!1;for(const s of B)s.holding!==void 0&&s.holding!==S&&(c.push(s.time),S=s.holding);let D=0;const p=.05,u=[...c];for(const s of y){let v=-1,A=p;for(let w=0;w<u.length;w++){const b=Math.abs(u[w]-s);b<A&&(A=b,v=w)}v!==-1&&(D++,u.splice(v,1))}return D/y.length}}const Gt={class:"play-page"},qt={key:0,class:"setup-container"},zt={key:0,class:"processing-overlay"},jt={class:"loader-content"},Vt={class:"progress-bar"},Yt={key:0,class:"time-left"},Wt={key:1},Ht={key:2,class:"failure-log"},Xt={class:"fail-tag"},Jt={key:1,class:"desc"},Kt={key:2,class:"desc map-notice"},Zt={class:"difficulty-select"},Qt={class:"diff-header"},ea={class:"slider-container"},ta={key:1,class:"setup-container"},aa={class:"processing-overlay"},sa={class:"loader-content"},oa={class:"progress-bar"},na={class:"status-text"},la={class:"smart-gen-logs"},ia={key:3,class:"mode-modal-overlay"},ra={class:"mode-modal glass-panel"},ua={class:"mode-header-row"},ca={class:"mode-options"},da={key:0,class:"rec-badge"},fa="umm_audio_db",ve="audio_files",va=Me({__name:"play",setup(Y){const B=Ve(),y=k("upload"),c=k(null),{analyzeAudio:S}=Ct(),D=k(!1),p=k([]),u=k(0),s=k(""),v=k(null),A=me(()=>p.value.slice(-6)),w=k(null),b=k([]),P=k([]),m=k(!1),g=k({step:"",percent:0}),r=k(0),h=k(0),i=k(null),L=k(null),N=k(null),{user:F}=Ue(),ie=je(),G=k(!1),Z=k(!1),ne=k(!1),V=k(!1),Q=k(!1),_=k(!1),n=k(1),C=me(()=>n.value<8?"EASY":n.value<16?"NORMAL":n.value<24?"HARD":"IMPOSSIBLE"),q=a=>a<8?"#00ff88":a<16?"#ffff00":a<24?"#ff8800":"#ff0000",re=a=>a>=60?0:Math.max(0,(60-a)/10),H=async a=>{if(G.value=!1,V.value=a==="practice",Q.value=a==="tutorial",a==="tutorial"){if(localStorage.setItem("umm_guide_seen","true"),_.value=!1,i.value&&(!i.value.autoplayLog||i.value.autoplayLog.length===0)){console.log("[Tutorial] Generating AI path for existing map...");const e=new Se({difficulty:i.value.difficulty||5,density:1,portalFrequency:.15});i.value.engineObstacles&&(e.obstacles=i.value.engineObstacles.map(d=>({...d}))),i.value.enginePortals&&(e.portals=i.value.enginePortals.map(d=>({...d}))),e.totalLength=(i.value.duration||120)*e.baseSpeed+1e3,e.computeAutoplayLog(200,360)&&e.autoplayLog.length>0&&(i.value.autoplayLog=e.autoplayLog,console.log("[Tutorial] AI Path Generated with",e.autoplayLog.length,"points"))}y.value="play"}else y.value="play"},ue=async a=>{if("type"in a&&a.type==="storage"){const f=a.data;if(i.value=f.mapData,b.value=f.mapData.beatTimes,P.value=f.mapData.sections,n.value=f.mapData.difficulty,f.mapData.audioData){const d=new(window.AudioContext||window.webkitAudioContext),x=await(await fetch(f.mapData.audioData)).arrayBuffer();w.value=await d.decodeAudioData(x),G.value=!0}else if(f.mapData._id){console.log("Loading recent map audio from IndexedDB...",f.mapData._id);try{const d=await Ie(f.mapData._id);if(d){const l=new(window.AudioContext||window.webkitAudioContext),x=await d.arrayBuffer();w.value=await l.decodeAudioData(x),G.value=!0}else alert("ì˜¤ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (IDB Miss)")}catch(d){console.error(d)}}else alert("ì˜¤ë””ì˜¤ ë°ì´í„°ê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");return}const e=a;c.value=e,m.value=!0,r.value=Date.now(),Z.value=!1;try{const f=new(window.AudioContext||window.webkitAudioContext);g.value={step:"SONG ANALYSIS",percent:0};const d=await S(e,n.value,W=>{if(g.value={step:"SONG ANALYSIS",percent:W.percent},W.percent>5){const ge=(Date.now()-r.value)/1e3,ce=ge/(W.percent/100);h.value=Math.max(0,ce-ge)}});if(w.value=d.buffer,b.value=d.obstacles,P.value=d.sections,d.duration<10){alert("10ì´ˆ ì´ìƒì˜ ë…¸ë˜ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤. (í˜„ì¬: "+d.duration.toFixed(1)+"ì´ˆ)"),m.value=!1;return}const l=d.duration,x=d.obstacles,M=d.sections,z=re(l),ae=Math.min(30,n.value+z);z>.5&&console.log(`[Difficulty] Short song detected. Adjusted difficulty: ${n.value} -> ${ae.toFixed(2)}`);const $=new Se({difficulty:ae,density:1,portalFrequency:.15}),se=Date.now()+Math.floor(Math.random()*1e6);let oe=!1,le=null;for(let W=0;;W++){const ge=W===0?"MOVEMENT PATH GENERATION":"FIXING IMPOSSIBLE PARTS...";g.value={step:ge,percent:W%10*10},W===0&&await new Promise(X=>setTimeout(X,600));let ce;if(W>0&&L.value&&le){const X=L.value.x,Ce=(le.autoplayLog||[]).find(Fe=>Fe.x>=X),$e=Ce?Ce.time:X/350,Ee=Math.max(0,$e-3);console.log(`[SmartGen] Resuming from ${Ee.toFixed(2)}s (Fail at ${$e.toFixed(2)}s)`),ce={time:Ee,stateEvents:le.stateEvents,beatActions:le.beatActions,obstacles:le.obstacles,portals:le.portals}}const Ne=ce?{...ce,obstacles:[...ce.obstacles],portals:[...ce.portals]}:void 0;if($.generateMap(x,M,l,se+W,!1,W,d.bpm,d.measureLength,d.volumeProfile,Ne),oe=await $.computeAutoplayLogAsync(200,360,X=>{g.value.percent=Math.floor(X*100)}),oe){g.value={step:"MAP GENERATION",percent:100},await new Promise(X=>setTimeout(X,500)),g.value={step:"MAP ADJUSTMENT",percent:100},await new Promise(X=>setTimeout(X,500)),g.value={step:"MAP SAVING",percent:100},L.value=null;break}if($.validationFailureInfo&&(L.value={x:Math.floor($.validationFailureInfo.x),y:Math.floor($.validationFailureInfo.y),rawObstacles:$.validationFailureInfo.nearObstacles},Ye(()=>O()),le={stateEvents:[...$.lastStateEvents],beatActions:[...$.lastBeatActions],obstacles:[...$.obstacles],portals:[...$.portals],autoplayLog:[...$.autoplayLog]}),await new Promise(X=>setTimeout(X,10)),W>50){console.warn("Max retries reached.");break}}if(oe)await new Promise(W=>setTimeout(W,500)),i.value={title:e.name.substring(0,100),difficulty:n.value,seed:se,engineObstacles:$.obstacles,enginePortals:$.portals,autoplayLog:$.autoplayLog,duration:l,beatTimes:x,sections:M,bpm:d.bpm,measureLength:d.measureLength,audioData:null},await U(i.value),fe(i.value),g.value.step="COMPLETED";else throw new Error("ì§€ë‚˜ê°ˆ ìˆ˜ ìˆëŠ” ë§µì„ ìƒì„±í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");setTimeout(()=>{m.value=!1,G.value=!0},500)}catch(f){console.error(f),m.value=!1,alert(f.message||"ì˜¤ë””ì˜¤ ë¶„ì„ ë˜ëŠ” ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}},fe=async a=>{const e=JSON.parse(localStorage.getItem("umm_recent_maps")||"[]"),f={id:Date.now(),name:a.title,timestamp:Date.now(),mapData:{...a,audioData:null}};e.unshift(f),localStorage.setItem("umm_recent_maps",JSON.stringify(e.slice(0,10)))},o=()=>{y.value="play"},T=()=>{sessionStorage.getItem("umm_is_test")?(sessionStorage.removeItem("umm_is_test"),B.push("/editor")):(y.value="upload",G.value=!1,V.value=!1,Q.value=!1)},R=async(a,e)=>{y.value="smart_gen",D.value=!0,p.value=[];const f=new Se;v.value=f;const d=new Ut(f),l=Ze(()=>{p.value=[...d.log],u.value=d.progress,s.value=d.status},100),x=await d.generate(a,e);clearInterval(l),x?(i.value={...e,engineObstacles:f.obstacles,enginePortals:f.portals,autoplayLog:f.autoplayLog},setTimeout(()=>{D.value=!1,y.value="play",sessionStorage.setItem("umm_edit_map",JSON.stringify(i.value))},1500)):(alert("Generation failed to reach target accuracy."),D.value=!1,y.value="upload")},O=()=>{if(!N.value||!L.value)return;const a=N.value.getContext("2d");if(!a)return;const{x:e,y:f,rawObstacles:d}=L.value,l=N.value.width,x=N.value.height;a.fillStyle="#050510",a.fillRect(0,0,l,x);const M=.5,z=e-l/2/M,ae=360-x/2/M;a.strokeStyle="rgba(255,255,255,0.05)";for(let $=0;$<l;$+=20)a.beginPath(),a.moveTo($,0),a.lineTo($,x),a.stroke();d.forEach($=>{a.save(),a.translate(($.x-z)*M,($.y-ae)*M),$.angle&&a.rotate($.angle*Math.PI/180),a.fillStyle=$.type==="spike"?"#ff4444":"#555",a.strokeStyle="#ff00ff",a.lineWidth=1;const se=$.width*M,oe=$.height*M;$.type==="spike"?(a.beginPath(),$.y>300?(a.moveTo(0,oe),a.lineTo(se/2,0),a.lineTo(se,oe)):(a.moveTo(0,0),a.lineTo(se/2,oe),a.lineTo(se,0)),a.fill(),a.stroke()):(a.fillRect(0,0,se,oe),a.strokeRect(0,0,se,oe)),a.restore()}),a.fillStyle="#fff",a.shadowBlur=10,a.shadowColor="#00ffff",a.beginPath(),a.arc((e-z)*M,(f-ae)*M,5,0,Math.PI*2),a.fill()},U=async a=>{if(!Z.value&&F.value&&!(V.value||Q.value)&&!(!c.value&&!i.value?.audioUrl))try{const e={title:(c.value?.name||i.value?.title||"Unknown Map").substring(0,100),difficulty:a.difficulty,seed:b.value.length*777+Math.floor(a.duration*100),beatTimes:b.value,sections:P.value,engineObstacles:a.engineObstacles,enginePortals:a.enginePortals,autoplayLog:a.autoplayLog,duration:a.duration,creatorName:F.value?.username||"Guest",isShared:!1};let f=null,d=!1;c.value&&w.value?(e.audioUrl=`/audio/${c.value.name}`,console.log(`[Audio] Trimming audio from ${w.value.duration}s to ${a.duration}s`),f=await He(w.value,a.duration),f.length>Xe?(console.log(`[Audio] Trimmed audio (${(f.length/1024/1024).toFixed(2)}MB) exceeds limit, will use chunked upload`),d=!0):e.audioData=f):i.value?.audioUrl&&(e.audioUrl=i.value.audioUrl,i.value.audioData&&i.value.audioData.length<100*1024*1024&&(e.audioData=i.value.audioData)),d&&(e.audioData=null,e.audioChunks=[]);const l=await $fetch("/api/maps",{method:"POST",body:e});if(Z.value=!0,console.log(`[Database] Map successfully saved. ID: ${l._id}`),i.value&&(i.value._id=l._id),d&&f){console.log("[Audio] Starting chunked upload...");const x=Je(f,Ke);for(let M=0;M<x.length;M++)console.log(`[Audio] Uploading chunk ${M+1}/${x.length}...`),await $fetch(`/api/maps/${l._id}/audio-chunk`,{method:"POST",body:{chunkIndex:M,chunkData:x[M],totalChunks:x.length}});console.log(`[Audio] All ${x.length} chunks uploaded successfully!`)}if(!e.audioData&&!d&&c.value){console.log("Saving original audio to local IndexedDB for fast auto-load...");try{await Be(l._id,c.value),console.log("Audio successfully saved to local IndexedDB!")}catch(x){console.error("Failed to save to IndexedDB",x)}}}catch(e){console.error("Failed to save map auto-registration:",e)}},ee=async a=>{if(!i.value?._id||(!V.value&&!Q.value&&a.score>(i.value.bestScore||0)&&(i.value.bestScore=a.score),V.value)||!F.value)return;const e=Q.value?"tutorial_mode":i.value?._id;if(e)try{(await $fetch(`/api/maps/${e}/record`,{method:"POST",body:{score:a.score,progress:a.progress,username:F.value?.username||"Guest"}})).updated&&console.log(`[Record] New best record: ${a.score}`)}catch(f){console.error("Failed to update record:",f)}},De=async a=>{i.value=a,b.value=a.beatTimes||[],P.value=a.sections||[],n.value=a.difficulty||10;const e=new(window.AudioContext||window.webkitAudioContext),f=e.createBuffer(1,Math.max(1,e.sampleRate*(a.duration||10)),e.sampleRate);w.value=f,sessionStorage.getItem("umm_is_tutorial")==="true"?(sessionStorage.removeItem("umm_is_tutorial"),H("tutorial")):G.value=!0};async function ye(){localStorage.getItem("umm_guide_seen")||(_.value=!0,G.value=!0);const e=sessionStorage.getItem("umm_load_map"),f=sessionStorage.getItem("umm_smart_gen")==="true";if(e)try{const l=JSON.parse(e);if(sessionStorage.removeItem("umm_load_map"),f&&sessionStorage.removeItem("umm_smart_gen"),i.value=l,b.value=l.beatTimes,P.value=l.sections,n.value=l.difficulty,l.audioData||l.audioUrl)try{const x=window.AudioContext||window.webkitAudioContext,M=new x;let z=null;if(l.audioData)z=await(await fetch(l.audioData)).arrayBuffer();else if(l.audioUrl){const ae=await fetch(l.audioUrl);ae.ok&&(z=await ae.arrayBuffer())}if(z)if(w.value=await M.decodeAudioData(z),f){R(z,l);return}else{G.value=!0;return}}catch(x){console.error("Audio load error",x)}f?(alert("Smart Gen requires audio!"),y.value="upload"):await De(l);return}catch(l){console.error("Failed to parse session map:",l)}const d=ie.query.map||ie.query.mapId;if(d)try{m.value=!0;const l=await $fetch(`/api/maps/${d}`);if(l)if(i.value=l,b.value=l.beatTimes,P.value=l.sections,n.value=l.difficulty,l.audioData||l.audioUrl)try{let x=null;if(l.audioData&&(console.log("Loading audio from Base64 Data..."),x=await(await fetch(l.audioData)).arrayBuffer()),!x){console.log("Checking local IndexedDB for audio...");try{const M=await Ie(l._id);M&&(console.log("Found audio in local DB!"),x=await M.arrayBuffer())}catch(M){console.warn("IndexedDB check failed",M)}}if(!x&&l.audioUrl){console.log("Loading audio from URL:",l.audioUrl);try{const M=await fetch(l.audioUrl);M.ok?x=await M.arrayBuffer():console.warn("Audio URL fetch failed:",M.status)}catch(M){console.warn("Audio URL fetch error",M)}}if(x){const M=window.AudioContext||window.webkitAudioContext,z=new M;w.value=await z.decodeAudioData(x),G.value=!0}else console.log("Could not find audio source. Prompting user."),alert(`ì˜¤ë””ì˜¤ íŒŒì¼ì„ ìë™ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. (ì„œë²„/ë¡œì»¬ ì €ì¥ì†Œ ì—†ìŒ)
ì›ë³¸ ìŒì•… íŒŒì¼ì„ ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.`)}catch(x){console.warn("Auto-load failed, waiting for user file",x),alert("ì˜¤ë””ì˜¤ ë¡œë”© ì‹¤íŒ¨. íŒŒì¼ì„ ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•´ì£¼ì„¸ìš”.")}else await De(l)}catch(l){console.error("Failed to load map:",l)}finally{m.value=!1}}xe(ye),he(()=>ie.query.map,a=>{a&&ye()}),he(()=>ie.query.mapId,a=>{a&&ye()});const Te=()=>new Promise((a,e)=>{const f=indexedDB.open(fa,1);f.onupgradeneeded=d=>{const l=d.target.result;l.objectStoreNames.contains(ve)||l.createObjectStore(ve)},f.onsuccess=d=>a(d.target.result),f.onerror=d=>e(d)}),Be=async(a,e)=>{const f=await Te();return new Promise((d,l)=>{const z=f.transaction(ve,"readwrite").objectStore(ve).put(e,a);z.onsuccess=()=>d(),z.onerror=()=>l(z.error)})},Ie=async a=>{const e=await Te();return new Promise((f,d)=>{const M=e.transaction(ve,"readonly").objectStore(ve).get(a);M.onsuccess=()=>f(M.result),M.onerror=()=>d(M.error)})};return(a,e)=>{const f=It,d=We;return I(),E("div",Gt,[e[24]||(e[24]=t("div",{class:"background-anim"},null,-1)),y.value==="upload"?(I(),E("div",qt,[m.value?(I(),E("div",zt,[t("div",jt,[e[8]||(e[8]=t("div",{class:"wave-loader"},"â—†",-1)),t("h2",null,j(g.value.step||"ë§µ ìƒì„± ì¤‘..."),1),t("div",Vt,[t("div",{class:"fill",style:be({width:g.value.percent+"%",animation:"none"})},null,4)]),h.value>0?(I(),E("p",Yt,"ì˜ˆìƒ ë‚¨ì€ ì‹œê°„: ì•½ "+j(Math.ceil(h.value))+"ì´ˆ",1)):g.value.percent>0?(I(),E("p",Wt,"ê±°ì˜ ë‹¤ ë˜ì—ˆìŠµë‹ˆë‹¤...")):J("",!0),L.value?(I(),E("div",Ht,[t("span",Xt,"CRITICAL BLOCKAGE AT "+j(L.value.x),1),t("canvas",{ref_key:"failCanvas",ref:N,width:"300",height:"150",class:"fail-preview"},null,512),e[7]||(e[7]=t("div",{class:"fail-details"}," AI failed to find a path through this section. ",-1))])):J("",!0)])])):J("",!0),e[14]||(e[14]=t("div",{class:"header-icon"},"â—†",-1)),e[15]||(e[15]=t("h1",{class:"title"},"ULTRA MUSIC MANIA",-1)),i.value?(I(),E("p",Kt,[e[9]||(e[9]=K(" ë¡œë“œëœ ë§µ: ",-1)),t("strong",null,j(i.value.title),1),e[10]||(e[10]=t("br",null,null,-1)),e[11]||(e[11]=K(" ê²Œì„ì„ ì‹œì‘í•˜ë ¤ë©´ ì´ ë§µì— ì‚¬ìš©ëœ ë…¸ë˜ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”. ",-1))])):(I(),E("p",Jt,"ìŒì•… íŒŒì¼ì„ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ ë§µì´ ìƒì„±ë©ë‹ˆë‹¤")),Ge(f,{onSelect:ue}),t("div",Zt,[t("div",Qt,[e[12]||(e[12]=t("label",null,"ë‚œì´ë„ ì„¤ì •:",-1)),t("span",{class:"diff-value",style:be({color:q(n.value)})},j(C.value)+" ("+j(n.value)+") ",5)]),t("div",ea,[qe(t("input",{type:"range",min:"1",max:"30","onUpdate:modelValue":e[0]||(e[0]=l=>n.value=l),class:"diff-slider"},null,512),[[ze,n.value,void 0,{number:!0}]]),e[13]||(e[13]=t("div",{class:"slider-marks"},[t("span",null,"EASY"),t("span",null,"NORMAL"),t("span",null,"HARD"),t("span",null,"INSANE")],-1))])])])):J("",!0),y.value==="smart_gen"?(I(),E("div",ta,[t("div",aa,[t("div",sa,[e[16]||(e[16]=t("div",{class:"wave-loader"},"âœ¨",-1)),e[17]||(e[17]=t("h2",null,"SMART GENERATION",-1)),t("div",oa,[t("div",{class:"fill",style:be({width:u.value+"%"})},null,4)]),t("p",na,j(s.value?s.value.toUpperCase().replace("_"," "):"PREPARING...")+" ("+j(u.value)+"%)",1),t("div",la,[(I(!0),E(_e,null,Ae(A.value,(l,x)=>(I(),E("div",{key:x,class:"log-entry"},j(l),1))),128))])])])])):J("",!0),y.value==="play"&&!G.value?(I(),Le(d,{key:2,audioBuffer:w.value,obstacles:b.value,sections:P.value,loadMap:i.value,difficulty:n.value,practiceMode:V.value,tutorialMode:Q.value,onRetry:o,onExit:T,onMapReady:U,onRecordUpdate:ee,onChangeMode:e[1]||(e[1]=l=>G.value=!0)},null,8,["audioBuffer","obstacles","sections","loadMap","difficulty","practiceMode","tutorialMode"])):J("",!0),G.value?(I(),E("div",ia,[t("div",ra,[t("div",ua,[e[18]||(e[18]=t("h2",null,"SELECT GAME MODE",-1)),t("button",{class:"debug-btn",onClick:e[2]||(e[2]=l=>ne.value=!0),title:"View Map Logic"}," ğŸ” Map Logic ")]),t("div",ca,[t("button",{onClick:e[3]||(e[3]=l=>H("practice")),class:"mode-btn practice"},[...e[19]||(e[19]=[t("div",{class:"mode-icon"},"ğŸ› ï¸",-1),t("h3",null,"PRACTICE MODE",-1),t("p",null,[K("ì²´í¬í¬ì¸íŠ¸ ì‚¬ìš© ê°€ëŠ¥"),t("br"),K("ê¸°ë¡ ë¯¸ì €ì¥")],-1)])]),t("button",{onClick:e[4]||(e[4]=l=>H("normal")),class:"mode-btn normal"},[...e[20]||(e[20]=[t("div",{class:"mode-icon"},"ğŸµ",-1),t("h3",null,"NORMAL MODE",-1),t("p",null,[K("í‘œì¤€ í”Œë ˆì´"),t("br"),K("ë­í‚¹ ê¸°ë¡ ì €ì¥")],-1)])]),t("button",{onClick:e[5]||(e[5]=l=>H("tutorial")),class:de(["mode-btn tutorial",{recommended:_.value}])},[e[21]||(e[21]=t("div",{class:"mode-icon"},"ğŸ“",-1)),_.value?(I(),E("div",da,"RECOMMENDED")):J("",!0),e[22]||(e[22]=t("h3",null,"TUTORIAL MODE",-1)),e[23]||(e[23]=t("p",null,[K("ê²Œì„ ê°€ì´ë“œ"),t("br"),K("ê¸°ì´ˆ ë°°ìš°ê¸°")],-1))],2)])])])):J("",!0),ne.value?(I(),Le(Nt,{key:4,mapData:i.value,onClose:e[6]||(e[6]=l=>ne.value=!1)},null,8,["mapData"])):J("",!0)])}}}),Sa=ke(va,[["__scopeId","data-v-c08e7508"]]);export{Sa as default};
