import{e as pt,f as mt,r as y,i as yt,j as wt,C as St,c as w,a as i,k as L,d as de,p as D,v as O,t as C,B as Ve,n as V,F as le,l as me,s as kt,x as Mt,m as xt,g as Tt,o as S}from"./OCD2nr9N.js";import{G as Ce}from"./DP0Q2vyH.js";import{C as Ge,s as Pt}from"./CUbsk6PR.js";import{_ as Ct}from"./DlAUqK2U.js";const Et={class:"editor-page"},_t={class:"editor-header glass-panel"},It={class:"left"},Dt={class:"map-meta"},Ot={class:"creator"},At={class:"center"},Rt={class:"transport-controls"},Lt=["disabled"],Nt={key:0},Bt={key:0},Ut=["disabled"],Wt={key:0},bt={key:0},Vt={key:0},Gt={key:1},Yt={class:"right"},Ft={class:"config-summary"},Xt={class:"stat"},$t={class:"stat"},Ht={key:0,class:"drawer-header"},zt={key:1},Jt={class:"object-list"},Kt=["onClick"],Zt={class:"symbol"},qt={class:"name"},Qt=["onClick"],jt={class:"symbol"},el={class:"name"},tl={class:"grid-info"},ll={class:"timeline-container"},al=["max"],il={key:0,class:"drawer-header"},nl={key:1},ol={key:2,class:"properties-list"},sl={class:"prop-group"},rl={class:"prop-val-static"},ul={class:"prop-group"},dl={class:"input-pair"},hl={class:"prop-group"},fl={class:"input-pair"},vl={class:"prop-group"},cl={class:"rotation-controls"},gl={class:"input-pair"},pl={key:0,class:"prop-group"},ml=["value"],yl={class:"input-pair"},wl={key:0},Sl={key:1,class:"hint-text"},kl={key:2,class:"children-list"},Ml={key:3,class:"properties-list"},xl={class:"prop-group"},Tl={class:"prop-val-static"},Pl={key:4,class:"empty-selection"},Cl={class:"global-settings prop-group"},El={class:"audio-settings prop-group"},_l={class:"audio-upload"},Il={key:0,class:"audio-hint"},Dl={key:0,class:"modal-overlay"},Ol={class:"modal-box glass-panel"},Al={class:"progress-section"},Rl={class:"progress-bar"},Ll={class:"status-text"},Nl={class:"log-console"},Bl={class:"modal-actions"},Ul=["disabled"],Wl=pt({__name:"editor",setup(bl){const Ee=Tt(),{user:_e}=mt(),ae=new Ce,d=y({title:"NEW UNTITLED MAP",duration:60,difficulty:10,engineObstacles:[],enginePortals:[],beatTimes:[],sections:[],seed:0,bpm:120,measureLength:2}),K=y(60*350+500),k=y(0),M=y(1),u=y([]),ie=y("spike"),ne=y(!0),Ye=y(null),I=y(null),Ie=y(null),ye=["spike","block","saw","mini_spike","laser","spike_ball","v_laser","mine","orb","slope","triangle","steep_triangle","piston_v","falling_spike","hammer","rotor","cannon","spark_mine","laser_beam","crusher_jaw","swing_blade","growing_spike","planet","star","invisible_wall","fake_block"],Fe=["gravity_yellow","gravity_blue","speed_0.25","speed_0.5","speed_1","speed_2","speed_3","speed_4","mini_pink","mini_green","teleport_in","teleport_out"],Xe=e=>ae.getPortalSymbol(e)||"â– ",$e=e=>ae.getPortalSymbol(e),U=y([]),W=y(-1),Z=y([]),G=y(!1),Y=y(!1),we=y(0),oe=y(200),Se=y(360),B=y([]);let q=0,F=null,he=null,b=null;const Q=y(!1),E=y({x1:0,y1:0,x2:0,y2:0}),A=y(!1),X=y(!0),$=y(!0),ke=()=>{const e=A.value;A.value=window.innerWidth<=1024,!e&&A.value?(X.value=!1,$.value=!1):e&&!A.value&&(X.value=!0,$.value=!0)},De=y(!1),He=y([]),Me=y(0),ze=y(""),Je=y(!1),j=y(!1),se=y(!1),Ke=e=>({idle:"IDLE",analyzing_song:"SONG ANALYSIS",generating_path:"MOVEMENT PATH GENERATION",adjusting_path:"MOVEMENT PATH ADJUSTMENT",generating_map:"MAP GENERATION",adjusting_map:"MAP ADJUSTMENT",saving_map:"MAP SAVING",completed:"COMPLETED",failed:"FAILED"})[e]||e.toUpperCase().replace("_"," "),H=()=>{const e=JSON.stringify(d.value);U.value[W.value]!==e&&(U.value=U.value.slice(0,W.value+1),U.value.push(e),U.value.length>50?U.value.shift():W.value++)},Ze=()=>{W.value>0&&(W.value--,d.value=JSON.parse(U.value[W.value]))},qe=()=>{W.value<U.value.length-1&&(W.value++,d.value=JSON.parse(U.value[W.value]))};let xe=!1,fe=!1,ve=!1,ee="",Oe=0,Ae=0,Te=new Map;const Qe=(e,l,a)=>{const n=10/M.value;return Math.abs(e-a.x)<n&&Math.abs(l-a.y)<n?"tl":Math.abs(e-(a.x+a.width))<n&&Math.abs(l-a.y)<n?"tr":Math.abs(e-a.x)<n&&Math.abs(l-(a.y+a.height))<n?"bl":Math.abs(e-(a.x+a.width))<n&&Math.abs(l-(a.y+a.height))<n?"br":null},je=e=>{if(e.button===1){xe=!0,Oe=e.clientX,Ae=k.value,e.preventDefault();return}if(e.button===2){if(!I.value)return;Q.value=!0;const t=I.value.getBoundingClientRect(),o=I.value.width/t.width,T=I.value.height/t.height,s=(e.clientX-t.left)*o/M.value+k.value,r=(e.clientY-t.top)*T/M.value;E.value={x1:s,y1:r,x2:s,y2:r},e.preventDefault();return}if(e.button!==0||!I.value)return;const l=I.value.getBoundingClientRect(),a=I.value.width/l.width,n=I.value.height/l.height;let h=(e.clientX-l.left)*a/M.value+k.value,x=(e.clientY-l.top)*n/M.value;if(G.value&&(h=Math.round(h/25)*25,x=Math.round(x/25)*25),u.value.length===1){const t=Qe(h,x,u.value[0]);if(t){ve=!0,ee=t;return}}const c=at(h,x);if(c){if(G.value){const t=u.value.indexOf(c);t===-1?u.value.push(c):u.value.splice(t,1)}else u.value.includes(c)||(u.value=[c]);u.value.includes(c)&&(fe=!0,Te.clear(),u.value.forEach(t=>{Te.set(t,{x:t.x-h,y:t.y-x})}))}else G.value||(u.value=[]),it(h,x),H()},et=e=>{if(!I.value)return;const l=I.value.getBoundingClientRect(),a=I.value.width/l.width,n=I.value.height/l.height;let h=(e.clientX-l.left)*a/M.value+k.value,x=(e.clientY-l.top)*n/M.value;const c=h,t=x;if(G.value&&!Q.value&&(h=Math.round(h/25)*25,x=Math.round(x/25)*25),xe){const o=e.clientX-Oe;k.value=Math.max(0,Ae-o/M.value)}else if(Q.value)E.value.x2=c,E.value.y2=t;else if(ve&&u.value.length===1){const o=u.value[0];if(ee==="br")o.width=Math.max(10,h-o.x),o.height=Math.max(10,x-o.y);else if(ee==="bl"){const T=o.x+o.width;o.x=Math.min(T-10,h),o.width=T-o.x,o.height=Math.max(10,x-o.y)}else if(ee==="tr"){const T=o.y+o.height;o.y=Math.min(T-10,x),o.height=T-o.y,o.width=Math.max(10,h-o.x)}else if(ee==="tl"){const T=o.x+o.width,s=o.y+o.height;o.x=Math.min(T-10,h),o.y=Math.min(s-10,x),o.width=T-o.x,o.height=s-o.y}}else fe&&u.value.forEach(o=>{const T=Te.get(o);if(T){let s=c+T.x,r=t+T.y;G.value&&(s=Math.round(s/25)*25,r=Math.round(r/25)*25),o.x=s,o.y=r,"initialY"in o&&(o.initialY=r)}})},tt=()=>{if(Q.value){const e=Math.min(E.value.x1,E.value.x2),l=Math.max(E.value.x1,E.value.x2),a=Math.min(E.value.y1,E.value.y2),n=Math.max(E.value.y1,E.value.y2),h=c=>{const t=c.x,o=c.x+c.width,T=c.y,s=c.y+c.height;return!(o<e||t>l||s<a||T>n)},x=[...d.value.engineObstacles.filter(h),...d.value.enginePortals.filter(h)];u.value=x,Q.value=!1}else if(fe){if(u.value.length===1){const e=u.value[0];if(e.type==="planet"){const l=e.x+e.width/2,a=e.y+e.height/2;let n=null;for(const h of d.value.engineObstacles)if(h!==e&&h.type==="star"&&l>=h.x&&l<=h.x+h.width&&a>=h.y&&a<=h.y+h.height){n=h;break}n&&(console.log("Attaching Planet to Star"),n.children||(n.children=[]),d.value.engineObstacles=d.value.engineObstacles.filter(h=>h!==e),n.children.push(e),e.parentId="attached")}}H()}else ve&&H();xe=!1,fe=!1,ve=!1,ee=""},lt=e=>{if(e.ctrlKey){e.preventDefault();const l=e.deltaY>0?.9:1.1;M.value=Math.max(.1,Math.min(5,M.value*l))}else k.value=Math.max(0,k.value+e.deltaY)},at=(e,l)=>{for(const a of d.value.engineObstacles)if(e>=a.x&&e<=a.x+a.width&&l>=a.y&&l<=a.y+a.height)return a;for(const a of d.value.enginePortals)if(e>=a.x&&e<=a.x+a.width&&l>=a.y&&l<=a.y+a.height)return a;return null},it=(e,l)=>{const a=ie.value;if(ye.includes(a)){const n={x:e,y:l-25,width:50,height:50,type:a,angle:0,initialY:l-25,movement:{type:"none",range:0,speed:0,phase:0}};d.value.engineObstacles.push(n),u.value=[n]}else{const n={x:e,y:l-30,width:60,height:80,type:a,angle:0,activated:!1};d.value.enginePortals.push(n),u.value=[n]}},te=e=>(e.customData||(e.customData={}),e.customData),nt=e=>{if(u.value.length!==1)return;const l=u.value[0];l.movement||(l.movement={type:"none",range:0,speed:0,phase:0}),!(l.type==="rotor"&&e!=="rotate")&&(l.type==="piston_v"&&e!=="updown"||(e==="none"?l.movement.type="none":(l.movement.type=e,l.movement.range===0&&(l.movement.range=100),l.movement.speed===0&&(l.movement.speed=1))))},ce=()=>{u.value.length!==0&&(d.value.engineObstacles=d.value.engineObstacles.filter(e=>!u.value.includes(e)),d.value.enginePortals=d.value.enginePortals.filter(e=>!u.value.includes(e)),u.value=[],H())},Re=()=>{K.value=d.value.duration*350+500},ot=()=>{let e=0;const l=d.value.engineObstacles||[],a=d.value.enginePortals||[];for(let c=0;c<l.length;c++){const t=l[c].x+l[c].width;t>e&&(e=t)}for(let c=0;c<a.length;c++){const t=a[c].x+a[c].width;t>e&&(e=t)}const h=Math.max(2e3,e+1500),x=Math.max(10,Math.ceil((h-500)/350));d.value.duration!==x&&(d.value.duration=x,Re())};yt([()=>d.value.engineObstacles,()=>d.value.enginePortals],()=>{ot()},{deep:!0});const st=()=>Ie.value?.click(),rt=e=>{const l=e.target.files?.[0];if(!l)return;const a=new FileReader;a.onload=n=>{d.value.audioData=n.target?.result,d.value.audioUrl=`/audio/${l.name}`,(!d.value.title||d.value.title==="NEW UNTITLED MAP")&&(d.value.title=l.name.split(".")[0])},a.readAsDataURL(l)},ut=async()=>{if(Y.value){Y.value=!1,re();return}if(!b&&typeof window<"u"&&(b=new(window.AudioContext||window.webkitAudioContext)),d.value.audioData&&!he&&b)try{const n=await(await fetch(d.value.audioData)).arrayBuffer();he=await b.decodeAudioData(n)}catch(a){console.error("Failed to decode preview audio",a)}const e=new Ce;e.obstacles=[...d.value.engineObstacles],e.portals=[...d.value.enginePortals],e.totalLength=K.value;const l=await e.computeAutoplayLogAsync(200,360,()=>{});d.value.autoplayLog=e.autoplayLog,!(!l&&!confirm("AI cannot find a clear path! Preview anyway?"))&&(Y.value=!0,we.value=0,B.value=[],k.value=0,dt())},dt=()=>{!he||!b||(re(),F=b.createBufferSource(),F.buffer=he,F.connect(b.destination),F.start(0))},re=()=>{if(F){try{F.stop()}catch{}F=null}},ht=async()=>{if(!j.value){j.value=!0,console.log("Starting map test simulation...");try{const e=new Ce;e.obstacles=[...d.value.engineObstacles],e.portals=[...d.value.enginePortals],e.totalLength=K.value,console.log("Computing autoplay log..."),await new Promise(a=>setTimeout(a,50));const l=await e.computeAutoplayLogAsync(200,360,a=>{});if(d.value.autoplayLog=e.autoplayLog,console.log("Autoplay computation result:",l),!l&&!confirm("AI cannot finish this map! Play anyway?")){j.value=!1;return}sessionStorage.setItem("umm_edit_map",JSON.stringify(d.value)),sessionStorage.setItem("umm_is_test","true"),sessionStorage.setItem("umm_load_map",JSON.stringify(d.value)),Ee.push("/play")}catch(e){console.error("Test map error:",e),alert("An error occurred during test preparation: "+e.message),j.value=!1}}},ft=async()=>{if(!se.value){se.value=!0;try{const e=!d.value._id,l=e?"/api/maps":`/api/maps/${d.value._id}`,a=e?"POST":"PATCH";e&&(d.value.creatorName=_e.value?.username||"Guest");const n=d.value.audioData;if(n&&n.length>Ge){const h=Pt(n,Ge),x={...d.value,audioData:null,audioChunks:[]},t=(await $fetch(l,{method:a,body:x}))._id;e&&(d.value._id=t);for(let o=0;o<h.length;o++)await $fetch(`/api/maps/${t}/audio-chunk`,{method:"POST",body:{chunkIndex:o,chunkData:h[o],totalChunks:h.length}});alert(`Map saved! (Audio: ${h.length} chunks)`)}else{const h=await $fetch(l,{method:a,body:d.value});e&&(d.value._id=h._id),alert("Map saved successfully!")}}catch(e){console.error("Save error:",e);const l=e.response?._data?.statusMessage||e.message||"Unknown error";alert(`Failed to save map: ${l}`)}finally{se.value=!1}}};let Le;const Ne=()=>{if(!I.value)return;const e=I.value.getContext("2d");if(!e)return;const l=I.value.width,a=I.value.height,n=performance.now()/1e3;e.clearRect(0,0,l,a),e.fillStyle="#050510",e.fillRect(0,0,l,a),e.save(),e.scale(M.value,M.value),e.translate(-k.value,0),e.strokeStyle="rgba(255, 255, 255, 0.05)";const h=50,x=Math.floor(k.value/h)*h;for(let t=x;t<k.value+l/M.value;t+=h)e.beginPath(),e.moveTo(t,0),e.lineTo(t,a/M.value),e.stroke();for(let t=0;t<a/M.value;t+=h)e.beginPath(),e.moveTo(k.value,t),e.lineTo(k.value+l/M.value,t),e.stroke();if(e.fillStyle="rgba(255, 0, 0, 0.1)",e.fillRect(k.value,0,l/M.value,140),e.fillRect(k.value,580,l/M.value,a/M.value-580),e.strokeStyle="#ff3333",e.lineWidth=3,e.beginPath(),e.moveTo(k.value,140),e.lineTo(k.value+l/M.value,140),e.stroke(),e.beginPath(),e.moveTo(k.value,580),e.lineTo(k.value+l/M.value,580),e.stroke(),e.fillStyle="#ff3333",e.font="bold 12px Outfit",e.fillText("CEILING BOUNDARY",k.value+10,130),e.fillText("FLOOR BOUNDARY",k.value+10,575),d.value.autoplayLog&&d.value.autoplayLog.length>1){e.save(),e.strokeStyle="rgba(255, 0, 255, 0.4)",e.lineWidth=4,e.setLineDash([10,5]),e.beginPath(),e.moveTo(d.value.autoplayLog[0].x,d.value.autoplayLog[0].y);for(let t=1;t<d.value.autoplayLog.length;t++)e.lineTo(d.value.autoplayLog[t].x,d.value.autoplayLog[t].y);e.stroke(),e.setLineDash([]),e.globalAlpha=1,e.restore()}d.value.enginePortals.forEach(t=>{const o=ae.getPortalColor(t.type);e.save(),t.angle&&(e.translate(t.x+t.width/2,t.y+t.height/2),e.rotate(t.angle*Math.PI/180),e.translate(-(t.x+t.width/2),-(t.y+t.height/2))),e.fillStyle=o,e.shadowBlur=15,e.shadowColor=o,e.globalAlpha=.2,e.fillRect(t.x,t.y,t.width,t.height),e.globalAlpha=1,e.strokeStyle="#fff",e.lineWidth=2,e.strokeRect(t.x,t.y,t.width,t.height),e.fillStyle="#fff",e.font="bold 20px Outfit",e.textAlign="center",e.fillText(ae.getPortalSymbol(t.type),t.x+t.width/2,t.y+t.height/2+8),e.restore(),u.value.includes(t)&&(e.strokeStyle="#00ffff",e.lineWidth=3,e.strokeRect(t.x-5,t.y-5,t.width+10,t.height+10)),ne.value&&(e.strokeStyle="#00ff00",e.lineWidth=1,e.setLineDash([4,4]),e.strokeRect(t.x,t.y,t.width,t.height),e.setLineDash([]))}),d.value.engineObstacles.forEach(t=>{e.save(),t.angle!==void 0&&t.angle!==0&&(e.translate(t.x+t.width/2,t.y+t.height/2),e.rotate(t.angle*Math.PI/180),e.translate(-(t.x+t.width/2),-(t.y+t.height/2))),t.movement&&t.movement.type==="updown"&&(e.strokeStyle="rgba(0, 255, 255, 0.1)",e.beginPath(),e.moveTo(t.x+t.width/2,(t.initialY||t.y)-t.movement.range),e.lineTo(t.x+t.width/2,(t.initialY||t.y)+t.movement.range),e.stroke());const T=ae.getObstacleStateAt(t,n),s=t.x,r=T.y;if(T.angle,t.type==="spike"||t.type==="mini_spike")e.fillStyle="#ff4d4d",e.shadowBlur=10,e.shadowColor="#ff0000",e.beginPath(),r>300?(e.moveTo(s,r+t.height),e.lineTo(s+t.width/2,r),e.lineTo(s+t.width,r+t.height)):(e.moveTo(s,r),e.lineTo(s+t.width/2,r+t.height),e.lineTo(s+t.width,r)),e.closePath(),e.fill();else if(t.type==="block")e.fillStyle="#444",e.shadowBlur=5,e.shadowColor="#666",e.fillRect(s,r,t.width,t.height),e.fillStyle="#555",e.fillRect(s+2,r+2,t.width-4,t.height-4);else if(t.type==="mine"){e.fillStyle="#222",e.strokeStyle="#ff3333";let g=1;if(t.customData?.pulseSpeed){const P=t.customData.pulseSpeed||2,_=t.customData.pulseAmount||.2;g=1+Math.sin(n*P)*_}const p=t.width/2*g,f=s+t.width/2,v=r+t.height/2;e.beginPath(),e.arc(f,v,p,0,Math.PI*2),e.fill(),e.stroke();const m=8;e.beginPath();for(let P=0;P<m;P++){const _=Math.PI*2*P/m,N=p,R=p+6;e.moveTo(f+Math.cos(_)*N,v+Math.sin(_)*N),e.lineTo(f+Math.cos(_)*R,v+Math.sin(_)*R)}e.stroke()}else if(t.type==="planet"){const g=s+t.width/2,p=r+t.height/2,f=t.width/2,v=e.createRadialGradient(g,p-f*.3,f*.1,g,p,f);v.addColorStop(0,"#4488ff"),v.addColorStop(1,"#002266"),e.fillStyle=v,e.beginPath(),e.arc(g,p,f,0,Math.PI*2),e.fill();const m=t.customData?.orbitCount??2,P=t.customData?.orbitSpeed??1,_=t.customData?.orbitDistance??t.width*.8;for(let N=0;N<m;N++){const R=n*P+N*(Math.PI*2/m),z=g+Math.cos(R)*_,J=p+Math.sin(R)*_;e.fillStyle="#88ccff",e.beginPath(),e.arc(z,J,8,0,Math.PI*2),e.fill()}}else if(t.type==="star"){const g=s+t.width/2,p=r+t.height/2,f=t.width/2,v=1+Math.sin(n*5)*.05,m=e.createRadialGradient(g,p,f*.2,g,p,f*v);if(m.addColorStop(0,"#ffff88"),m.addColorStop(.5,"#ffaa00"),m.addColorStop(1,"rgba(255, 68, 0, 0)"),e.fillStyle=m,e.beginPath(),e.arc(g,p,f*1.2*v,0,Math.PI*2),e.fill(),e.fillStyle="#fff",e.beginPath(),e.arc(g,p,f*.6,0,Math.PI*2),e.fill(),t.children&&t.children.length>0){const _=t.children,N=t.customData?.orbitSpeed??1;_.forEach((R,z)=>{const J=n*N+z*(Math.PI*2/_.length),ge=t.customData?.orbitDistance??t.width*.85,pe=g+Math.cos(J)*ge,Be=p+Math.sin(J)*ge;if(e.fillStyle="#00ff88",e.beginPath(),e.arc(pe,Be,14,0,Math.PI*2),e.fill(),R.type==="planet"){const Ue=R.customData?.orbitCount??2,vt=R.customData?.orbitSpeed??2,We=R.customData?.orbitDistance??R.width*.8;for(let Pe=0;Pe<Ue;Pe++){const be=n*vt+Pe*(Math.PI*2/Ue),ct=pe+Math.cos(be)*We,gt=Be+Math.sin(be)*We;e.fillStyle="#fff",e.beginPath(),e.arc(ct,gt,4,0,Math.PI*2),e.fill()}}})}else{const _=t.customData?.orbitCount??3;if(_>0){const N=t.customData?.orbitSpeed??1,R=t.customData?.orbitDistance??t.width*.85;for(let z=0;z<_;z++){const J=n*N+z*(Math.PI*2/_),ge=g+Math.cos(J)*R,pe=p+Math.sin(J)*R;e.fillStyle="#00ff88",e.beginPath(),e.arc(ge,pe,14,0,Math.PI*2),e.fill()}}}}else if(["piston_v","hammer","rotor","cannon","spark_mine","laser_beam","crusher_jaw","swing_blade","falling_spike","growing_spike"].includes(t.type)){const g=s+t.width/2,p=r+t.height/2;if(t.type==="hammer"){e.save(),e.translate(g,p);const f=Math.sin(n*3)*.5;e.rotate(f),e.fillStyle="#666",e.fillRect(-5,-t.height/2,10,t.height*.7),e.fillStyle="#888",e.shadowBlur=10,e.shadowColor="#fff",e.fillRect(-t.width/2,t.height*.2-t.height/2,t.width,t.height*.3),e.strokeStyle="#fff",e.lineWidth=2,e.strokeRect(-t.width/2,t.height*.2-t.height/2,t.width,t.height*.3),e.restore()}else if(t.type==="rotor"){e.save(),e.translate(g,p);const f=n*8;e.rotate(f),e.fillStyle="#ff3333",e.shadowBlur=15,e.shadowColor="#ff0000";for(let v=0;v<3;v++)e.rotate(Math.PI*2/3),e.beginPath(),e.moveTo(0,0),e.lineTo(-5,-t.height/2),e.lineTo(5,-t.height/2),e.fill();e.fillStyle="#fff",e.beginPath(),e.arc(0,0,8,0,Math.PI*2),e.fill(),e.restore()}else if(t.type==="cannon")e.save(),e.translate(g,p),e.fillStyle="#444",e.fillRect(-t.width/2+5,-t.height/2+5,t.width-10,t.height-10),e.fillStyle="#000",e.beginPath(),e.arc(0,0,t.width/3,0,Math.PI*2),e.fill(),e.strokeStyle="#ff0000",e.lineWidth=3,e.strokeRect(-t.width/2+5,-t.height/2+5,t.width-10,t.height-10),e.restore();else if(t.type==="crusher_jaw"){e.fillStyle="#555",e.shadowBlur=10,e.shadowColor="#000",e.fillRect(s,r,t.width,t.height),e.fillStyle="#ff8800";const f=3,v=t.width/f,m=15;e.beginPath();for(let P=0;P<f;P++)e.moveTo(s+P*v,r+t.height),e.lineTo(s+P*v+v/2,r+t.height+m),e.lineTo(s+(P+1)*v,r+t.height);e.fill(),e.strokeStyle="#aaa",e.lineWidth=2,e.strokeRect(s,r,t.width,t.height)}else if(t.type==="falling_spike")e.save(),e.translate(g,p),e.fillStyle="#ff3333",e.shadowBlur=10,e.shadowColor="#ff0000",e.beginPath(),e.moveTo(-t.width/2,-t.height/2),e.lineTo(t.width/2,-t.height/2),e.lineTo(0,t.height/2),e.closePath(),e.fill(),e.strokeStyle="#fff",e.lineWidth=2,e.stroke(),e.restore();else if(t.type==="laser_beam"){e.fillStyle="rgba(255, 0, 0, 0.2)",e.fillRect(s,r,t.width,t.height);const f=Math.sin(n*20)*2+3;e.fillStyle="#ff0000",e.shadowBlur=10,e.shadowColor="#ff0000",e.fillRect(s,r+t.height/2-f/2,t.width,f),e.fillStyle="#444",e.fillRect(s,r,10,t.height),e.fillRect(s+t.width-10,r,10,t.height)}else if(t.type==="swing_blade"){e.save(),e.translate(g,r);const f=Math.sin(n*2)*.8;e.rotate(f),e.strokeStyle="#aaa",e.lineWidth=4,e.beginPath(),e.moveTo(0,0),e.lineTo(0,t.height),e.stroke(),e.translate(0,t.height),e.fillStyle="#ccc",e.shadowBlur=10,e.shadowColor="#fff",e.beginPath(),e.arc(0,0,t.width/2,0,Math.PI),e.fill(),e.fillStyle="#ff0000",e.beginPath(),e.arc(0,0,t.width/2,0,Math.PI,!0),e.fill(),e.restore()}else if(t.type==="growing_spike"){e.fillStyle="#444",e.fillRect(s,r+t.height-10,t.width,10);const f=t.height*(.5+Math.sin(n*3)*.4);e.fillStyle="#ff3333",e.beginPath(),e.moveTo(s+5,r+t.height-10),e.lineTo(s+t.width-5,r+t.height-10),e.lineTo(s+t.width/2,r+t.height-10-f),e.fill()}else if(t.type==="spark_mine"){e.save(),e.translate(g,p),e.strokeStyle="#ffff00",e.lineWidth=2;for(let f=0;f<8;f++)e.rotate(Math.PI/4),e.beginPath(),e.moveTo(0,0),e.lineTo(0,t.width/2+Math.random()*5),e.stroke();e.fillStyle="#ffaa00",e.shadowBlur=15,e.shadowColor="#ffff00",e.beginPath(),e.arc(0,0,t.width/4,0,Math.PI*2),e.fill(),e.restore()}else if(t.type==="piston_v"){s+t.width/2,r+t.height/2,e.save();const f=t.y>360;e.fillStyle="#444",e.shadowBlur=5,e.shadowColor="#000",f?e.fillRect(s,r+t.height-15,t.width,15):e.fillRect(s,r,t.width,15),e.fillStyle="#888";const v=t.width*.4,m=(Math.sin(n*2)+1)*.5*(t.height-40);f?(e.fillRect(s+(t.width-v)/2,r+t.height-15-m,v,m),e.fillStyle="#ff8800",e.fillRect(s,r+t.height-15-m-25,t.width,25),e.fillStyle="#000",e.beginPath(),e.moveTo(s,r+t.height-15-m-25),e.lineTo(s+10,r+t.height-15-m-25),e.lineTo(s,r+t.height-15-m-15),e.fill()):(e.fillRect(s+(t.width-v)/2,r+15,v,m),e.fillStyle="#ff8800",e.fillRect(s,r+15+m,t.width,25)),e.restore()}else t.type==="invisible_wall"?(e.strokeStyle="#rgba(255, 255, 255, 0.5)",e.lineWidth=1,e.setLineDash([5,5]),e.strokeRect(s,r,t.width,t.height),e.setLineDash([]),e.fillStyle="rgba(255, 255, 255, 0.1)",e.fillText("INVISIBLE",s,r+15)):t.type==="fake_block"?(e.fillStyle="rgba(255, 255, 255, 0.2)",e.fillRect(s,r,t.width,t.height),e.strokeStyle="#fff",e.strokeRect(s,r,t.width,t.height),e.fillStyle="#fff",e.font="10px Arial",e.fillText("FAKE",s+5,r+15)):(e.strokeStyle="#ff8800",e.lineWidth=2,e.strokeRect(s,r,t.width,t.height),e.fillStyle="#ff8800",e.font="10px Arial",e.fillText(t.type,s,r+15))}else if(t.type==="slope")e.fillStyle="#222",e.shadowBlur=15,e.shadowColor="#000",e.beginPath(),t.angle>0?(e.moveTo(s,r+t.height),e.lineTo(s+t.width,r),e.lineTo(s,r)):(e.moveTo(s+t.width,r+t.height),e.lineTo(s,r),e.lineTo(s+t.width,r)),e.closePath(),e.fill(),e.strokeStyle="rgba(100,200,255,0.3)",e.lineWidth=3,e.stroke();else if(t.type==="saw"){const g=s+t.width/2,p=r+t.height/2;e.save(),e.translate(g,p),e.scale(t.width/2,t.height/2),e.fillStyle="#ffaa00",e.shadowBlur=40/Math.max(t.width,t.height)*10,e.shadowColor="#ffaa00",e.beginPath(),e.arc(0,0,1,0,Math.PI*2),e.fill(),e.fillStyle="#ff6600";const f=10,v=n*8;for(let m=0;m<f;m++){const P=Math.PI*2*m/f+v;e.beginPath();const _=Math.cos(P)*.75,N=Math.sin(P)*.75;e.arc(_,N,.15,0,Math.PI*2),e.fill()}e.restore()}else if(t.type==="spike_ball"){const g=s+t.width/2,p=r+t.height/2,f=n*3;e.save(),e.translate(g,p),e.scale(t.width/2,t.height/2),e.fillStyle="#444";for(let m=0;m<8;m++){const P=Math.PI*2*m/8+f;e.beginPath(),e.moveTo(Math.cos(P-.2)*.8,Math.sin(P-.2)*.8),e.lineTo(Math.cos(P)*1.2,Math.sin(P)*1.2),e.lineTo(Math.cos(P+.2)*.8,Math.sin(P+.2)*.8),e.fill()}const v=e.createRadialGradient(-.3,-.3,.1,0,0,1);v.addColorStop(0,"#888"),v.addColorStop(1,"#222"),e.fillStyle=v,e.beginPath(),e.arc(0,0,.8,0,Math.PI*2),e.fill(),e.restore()}else if(t.type==="laser"||t.type==="v_laser"){const g=t.type==="v_laser",p=Math.sin(n*15)*5+10;e.strokeStyle="#ff3333",e.lineWidth=2,e.shadowBlur=Math.max(0,p),e.shadowColor="#ff0000",e.beginPath(),g?(e.moveTo(s+t.width/2,r),e.lineTo(s+t.width/2,r+t.height)):(e.moveTo(s,r+t.height/2),e.lineTo(s+t.width,r+t.height/2)),e.stroke(),e.strokeStyle="#fff",e.lineWidth=1,e.shadowBlur=0,e.stroke()}else if(t.type==="mine"){const g=s+t.width/2,p=r+t.height/2;e.save(),e.translate(g,p),e.scale(t.width/2,t.height/2);const f=Math.sin(n*10)*.1+.9;e.fillStyle="#ff3333",e.shadowBlur=10/Math.max(1,(t.width+t.height)/100),e.shadowColor="#ff0000",e.beginPath();for(let v=0;v<6;v++){const m=Math.PI/3*v+n*2;e.lineTo(Math.cos(m)*f,Math.sin(m)*f)}e.closePath(),e.fill(),e.restore()}else if(t.type==="orb"){const g=s+t.width/2,p=r+t.height/2;e.save(),e.translate(g,p),e.scale(t.width/2,t.height/2);const f=Math.sin(n*5)*.1+1,v=e.createRadialGradient(0,0,f*.1,0,0,f);v.addColorStop(0,"#fff"),v.addColorStop(.4,"#aa44ff"),v.addColorStop(1,"rgba(68,0,204,0)"),e.fillStyle=v,e.globalCompositeOperation="lighter",e.beginPath(),e.arc(0,0,f,0,Math.PI*2),e.fill(),e.globalCompositeOperation="source-over",e.restore()}ne.value&&(e.strokeStyle="#00ff00",e.lineWidth=1,e.setLineDash([4,4]),e.strokeRect(s,r,t.width,t.height),e.setLineDash([])),e.restore()});const c=K.value;if(e.strokeStyle="#00ff88",e.lineWidth=8,e.setLineDash([15,10]),e.beginPath(),e.moveTo(c,0),e.lineTo(c,a/M.value),e.stroke(),e.setLineDash([]),e.fillStyle="#00ff88",e.font="900 32px Outfit",e.textAlign="center",e.fillText("FINISH LINE",c,100),e.textAlign="left",u.value.forEach(t=>{if(e.save(),e.strokeStyle="#00ffff",e.lineWidth=2,e.setLineDash([5,5]),e.strokeRect(t.x,t.y,t.width,t.height),e.setLineDash([]),u.value.length===1){e.fillStyle="#fff";const o=6/M.value;e.fillRect(t.x-o,t.y-o,o*2,o*2),e.fillRect(t.x+t.width-o,t.y-o,o*2,o*2),e.fillRect(t.x-o,t.y+t.height-o,o*2,o*2),e.fillRect(t.x+t.width-o,t.y+t.height-o,o*2,o*2)}e.restore()}),Q.value){e.fillStyle="rgba(0, 255, 255, 0.1)",e.strokeStyle="#00ffff",e.lineWidth=1;const t=Math.min(E.value.x1,E.value.x2),o=Math.min(E.value.y1,E.value.y2),T=Math.abs(E.value.x2-E.value.x1),s=Math.abs(E.value.y2-E.value.y1);e.fillRect(t,o,T,s),e.strokeRect(t,o,T,s)}if(Y.value){if(B.value.length>1){e.save(),e.beginPath(),e.moveTo(B.value[0].x,B.value[0].y);for(let o=1;o<B.value.length;o++)e.lineTo(B.value[o].x,B.value[o].y);e.strokeStyle="rgba(0, 255, 255, 0.6)",e.lineWidth=14/M.value,e.lineCap="round",e.lineJoin="round",e.stroke(),e.restore()}const t=d.value.autoplayLog;if(t&&t.length>0){const o=performance.now()/1e3;q||(q=o);const T=o-q;q=o,we.value+=T;const s=200+we.value*350;let r=t[0];for(let g=0;g<t.length;g++){if(t[g].x>=s){if(g>0){const p=t[g-1],f=t[g],v=(s-p.x)/(f.x-p.x);r={x:s,y:p.y+(f.y-p.y)*v,holding:p.holding}}else r=t[g];break}r=t[t.length-1]}oe.value=r.x,Se.value=r.y,B.value.push({x:oe.value,y:Se.value}),B.value.length>500&&B.value.shift(),k.value=Math.max(0,oe.value-200),e.save(),e.fillStyle=r.holding?"#ff00ff":"#00ffff",e.shadowBlur=25,e.shadowColor=e.fillStyle,e.beginPath(),e.arc(oe.value,Se.value,18/M.value,0,Math.PI*2),e.fill(),e.restore(),oe.value>=K.value&&(Y.value=!1,q=0,re())}}else q=0;e.restore(),Le=requestAnimationFrame(Ne)},ue=e=>{u.value.forEach(l=>{"angle"in l&&(l.angle=(l.angle||0)+e,l.angle<0&&(l.angle+=360),l.angle>=360&&(l.angle-=360))}),H()};return wt(()=>{const e=sessionStorage.getItem("umm_edit_map");e&&(d.value=JSON.parse(e),sessionStorage.removeItem("umm_edit_map"),Re()),H(),typeof window<"u"&&!b&&(b=new(window.AudioContext||window.webkitAudioContext)),Ne();const l=n=>{if(!(n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement))if(n.key==="Shift"&&(G.value=!0),n.ctrlKey||n.metaKey)if(n.key==="c")u.value.length>0&&(Z.value=u.value.map(h=>({...h,_id:void 0})));else if(n.key==="x")u.value.length>0&&(Z.value=u.value.map(h=>({...h,_id:void 0})),ce());else if(n.key==="v"){if(Z.value.length>0){const h=Math.min(...Z.value.map(c=>c.x));Math.min(...Z.value.map(c=>c.y));const x=Z.value.map(c=>{const t={...c,x:k.value+(c.x-h)+100,y:c.y};return ye.includes(t.type)?d.value.engineObstacles.push(t):d.value.enginePortals.push(t),t});u.value=x,H()}}else n.key==="z"?Ze():n.key==="y"&&qe();else n.key==="Delete"||n.key==="Backspace"?u.value.length>0&&ce():n.key.toLowerCase()==="r"&&u.value.length>0&&ue(45)},a=n=>{n.key==="Shift"&&(G.value=!1)};window.addEventListener("keydown",l),window.addEventListener("keyup",a),St(()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",a),cancelAnimationFrame(Le),re(),re(),window.removeEventListener("resize",ke)}),ke(),window.addEventListener("resize",ke)}),(e,l)=>(S(),w("div",Et,[l[61]||(l[61]=i("div",{class:"background-anim"},null,-1)),i("header",_t,[i("div",It,[l[30]||(l[30]=i("h1",{class:"title"},[de("MAP_ARCHITECT "),i("span",{class:"version"},"v2.0")],-1)),i("div",Dt,[D(i("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>d.value.title=a),placeholder:"Map Title",class:"map-title-input"},null,512),[[O,d.value.title]]),i("span",Ot,"BY: "+C(Ve(_e)?.username||"Guest"),1)])]),i("div",At,[i("div",Rt,[A.value?(S(),w("button",{key:0,onClick:l[1]||(l[1]=a=>X.value=!X.value),class:V(["control-btn mobile-toggle",{active:X.value}])}," ðŸŽ¨ ",2)):L("",!0),i("button",{onClick:ht,class:"control-btn test",disabled:j.value},[l[31]||(l[31]=i("span",{class:"icon"},"â–¶",-1)),l[32]||(l[32]=de()),A.value?L("",!0):(S(),w("span",Nt,C(j.value?"TESTING...":"TEST"),1))],8,Lt),i("button",{onClick:ut,class:V(["control-btn tutorial",{active:Y.value}])},[l[33]||(l[33]=i("span",{class:"icon"},"ðŸŽ“",-1)),l[34]||(l[34]=de()),A.value?L("",!0):(S(),w("span",Bt,C(Y.value?"STOP":"TUTORIAL"),1))],2),i("button",{onClick:ft,class:"control-btn save",disabled:se.value},[l[35]||(l[35]=i("span",{class:"icon"},"ðŸ’¾",-1)),l[36]||(l[36]=de()),A.value?L("",!0):(S(),w("span",Wt,C(se.value?"SAVING...":"SAVE"),1))],8,Ut),i("button",{onClick:l[2]||(l[2]=a=>ne.value=!ne.value),class:V(["control-btn",{active:ne.value}])},[l[37]||(l[37]=i("span",{class:"icon"},"â›¶",-1)),l[38]||(l[38]=de()),A.value?L("",!0):(S(),w("span",bt,"HITBOX"))],2),A.value?(S(),w("button",{key:1,onClick:l[3]||(l[3]=a=>$.value=!$.value),class:V(["control-btn mobile-toggle",{active:$.value}])}," âš™ï¸ ",2)):L("",!0),i("button",{onClick:l[4]||(l[4]=a=>Ve(Ee).push("/maps")),class:"control-btn exit"},[A.value?(S(),w("span",Gt,"âœ•")):(S(),w("span",Vt,"EXIT"))])])]),i("div",Yt,[i("div",Ft,[i("span",Xt,"OBJ: "+C(d.value.engineObstacles.length),1),i("span",$t,"PORT: "+C(d.value.enginePortals.length),1)])])]),i("div",{class:V(["main-layout",{"is-mobile":A.value}])},[i("aside",{class:V(["sidebar left-sidebar glass-panel",{"mobile-drawer":A.value,open:X.value}])},[A.value?(S(),w("div",Ht,[l[39]||(l[39]=i("h3",null,"PALETTE",-1)),i("button",{onClick:l[5]||(l[5]=a=>X.value=!1),class:"close-drawer"},"âœ•")])):(S(),w("h3",zt,"PALETTE")),i("div",Jt,[(S(),w(le,null,me(ye,a=>i("div",{key:a,class:V(["palette-item",{selected:ie.value===a}]),onClick:n=>ie.value=a},[i("div",Zt,C(Xe(a)),1),i("span",qt,C(a.split("_").join(" ").toUpperCase()),1)],10,Kt)),64)),l[40]||(l[40]=i("div",{class:"separator"},"PORTALS",-1)),(S(),w(le,null,me(Fe,a=>i("div",{key:a,class:V(["palette-item portal",{selected:ie.value===a}]),onClick:n=>ie.value=a},[i("div",jt,C($e(a)),1),i("span",el,C(a.split("_").join(" ").toUpperCase()),1)],10,Qt)),64))])],2),i("main",{class:"workspace glass-panel",ref_key:"workspaceRef",ref:Ye,onMousedown:je,onMousemove:et,onMouseup:tt,onWheel:lt,onContextmenu:l[7]||(l[7]=kt(()=>{},["prevent"]))},[i("canvas",{ref_key:"canvasRef",ref:I,width:"1200",height:"600",class:"editor-canvas"},null,512),i("div",tl,[i("span",null,"ZOOM: "+C((M.value*100).toFixed(0))+"%",1),i("span",null,"X: "+C(Math.floor(k.value)),1)]),i("div",ll,[D(i("input",{type:"range",min:"0",max:K.value,"onUpdate:modelValue":l[6]||(l[6]=a=>k.value=a),class:"timeline-slider"},null,8,al),[[O,k.value,void 0,{number:!0}]])])],544),i("aside",{class:V(["sidebar right-sidebar glass-panel",{"mobile-drawer":A.value,open:$.value}])},[A.value?(S(),w("div",il,[l[41]||(l[41]=i("h3",null,"PROPERTIES",-1)),i("button",{onClick:l[8]||(l[8]=a=>$.value=!1),class:"close-drawer"},"âœ•")])):(S(),w("h3",nl,"PROPERTIES")),u.value.length===1?(S(),w("div",ol,[i("div",sl,[l[42]||(l[42]=i("label",null,"TYPE",-1)),i("span",rl,C(u.value[0].type.toUpperCase()),1)]),i("div",ul,[l[43]||(l[43]=i("label",null,"POSITION X / Y",-1)),i("div",dl,[D(i("input",{type:"number","onUpdate:modelValue":l[9]||(l[9]=a=>u.value[0].x=a)},null,512),[[O,u.value[0].x,void 0,{number:!0}]]),D(i("input",{type:"number","onUpdate:modelValue":l[10]||(l[10]=a=>u.value[0].y=a)},null,512),[[O,u.value[0].y,void 0,{number:!0}]])])]),i("div",hl,[l[44]||(l[44]=i("label",null,"SIZE W / H",-1)),i("div",fl,[D(i("input",{type:"number","onUpdate:modelValue":l[11]||(l[11]=a=>u.value[0].width=a)},null,512),[[O,u.value[0].width,void 0,{number:!0}]]),D(i("input",{type:"number","onUpdate:modelValue":l[12]||(l[12]=a=>u.value[0].height=a)},null,512),[[O,u.value[0].height,void 0,{number:!0}]])])]),i("div",vl,[l[45]||(l[45]=i("label",null,"ROTATION (DEG)",-1)),i("div",cl,[i("button",{onClick:l[13]||(l[13]=a=>ue(-45)),title:"Rotate -45",class:"rot-btn"},"â†º"),i("button",{onClick:l[14]||(l[14]=a=>ue(45)),title:"Rotate 45",class:"rot-btn"},"â†»"),i("button",{onClick:l[15]||(l[15]=a=>ue(90)),title:"Rotate 90",class:"rot-btn"},"90Â°"),i("button",{onClick:l[16]||(l[16]=a=>ue(180)),title:"Rotate 180",class:"rot-btn"},"180Â°")]),i("div",gl,[D(i("input",{type:"number","onUpdate:modelValue":l[17]||(l[17]=a=>u.value[0].angle=a)},null,512),[[O,u.value[0].angle,void 0,{number:!0}]]),D(i("input",{type:"range",min:"0",max:"360","onUpdate:modelValue":l[18]||(l[18]=a=>u.value[0].angle=a)},null,512),[[O,u.value[0].angle,void 0,{number:!0}]])])]),u.value[0].movement?(S(),w("div",pl,[l[49]||(l[49]=i("label",null,"MOVEMENT TYPE",-1)),i("select",{value:u.value[0].movement.type,onChange:l[19]||(l[19]=a=>nt(a.target.value))},[...l[46]||(l[46]=[Mt('<option value="none" data-v-6876bfb9>NONE</option><option value="updown" data-v-6876bfb9>UP-DOWN</option><option value="leftright" data-v-6876bfb9>LEFT-RIGHT</option><option value="rotate" data-v-6876bfb9>ROTATE</option><option value="bounce" data-v-6876bfb9>BOUNCE</option>',5)])],40,ml),u.value[0].movement.type!=="none"?(S(),w(le,{key:0},[l[47]||(l[47]=i("label",null,"SPEED / RANGE",-1)),i("div",yl,[D(i("input",{type:"number",step:"0.1","onUpdate:modelValue":l[20]||(l[20]=a=>u.value[0].movement.speed=a),placeholder:"Speed"},null,512),[[O,u.value[0].movement.speed,void 0,{number:!0}]]),D(i("input",{type:"number","onUpdate:modelValue":l[21]||(l[21]=a=>u.value[0].movement.range=a),placeholder:"Range"},null,512),[[O,u.value[0].movement.range,void 0,{number:!0}]])]),l[48]||(l[48]=i("label",null,"PHASE OFFSET",-1)),D(i("input",{type:"number",step:"0.1","onUpdate:modelValue":l[22]||(l[22]=a=>u.value[0].movement.phase=a)},null,512),[[O,u.value[0].movement.phase,void 0,{number:!0}]])],64)):L("",!0)])):L("",!0),["planet","star"].includes(u.value[0].type)?(S(),w(le,{key:1},[u.value[0].type==="planet"?(S(),w("div",wl,[l[50]||(l[50]=i("label",null,"ORBIT MOON COUNT",-1)),D(i("input",{type:"number","onUpdate:modelValue":l[23]||(l[23]=a=>te(u.value[0]).orbitCount=a),placeholder:"0 or 2"},null,512),[[O,te(u.value[0]).orbitCount,void 0,{number:!0}]])])):L("",!0),l[51]||(l[51]=i("label",null,"ORBIT SPEED",-1)),D(i("input",{type:"number",step:"0.1","onUpdate:modelValue":l[24]||(l[24]=a=>te(u.value[0]).orbitSpeed=a),placeholder:"Speed"},null,512),[[O,te(u.value[0]).orbitSpeed,void 0,{number:!0}]]),l[52]||(l[52]=i("label",null,"ORBIT DISTANCE",-1)),D(i("input",{type:"number","onUpdate:modelValue":l[25]||(l[25]=a=>te(u.value[0]).orbitDistance=a),placeholder:"Distance"},null,512),[[O,te(u.value[0]).orbitDistance,void 0,{number:!0}]]),u.value[0].type==="star"?(S(),w("div",Sl," Drag a Planet onto this Star to attach it! ")):L("",!0),u.value[0].children&&u.value[0].children.length>0?(S(),w("div",kl,[i("label",null,"ATTACHED PLANETS: "+C(u.value[0].children.length),1),(S(!0),w(le,null,me(u.value[0].children,(a,n)=>(S(),w("div",{key:n,class:"child-item"},[i("span",null,"Planet "+C(n+1),1)]))),128))])):L("",!0)],64)):L("",!0),i("button",{onClick:ce,class:"delete-btn"},"DELETE OBJECT")])):u.value.length>1?(S(),w("div",Ml,[i("div",xl,[l[53]||(l[53]=i("label",null,"MULTIPLE SELECTION",-1)),i("span",Tl,C(u.value.length)+" OBJECTS",1)]),i("button",{onClick:ce,class:"delete-btn"},"DELETE ALL")])):(S(),w("div",Pl," SELECT OBJECTS TO MODIFY ")),i("div",Cl,[l[54]||(l[54]=i("h3",null,"LEVEL CONFIG",-1)),l[55]||(l[55]=i("label",null,"DIFFICULTY",-1)),D(i("input",{type:"number","onUpdate:modelValue":l[26]||(l[26]=a=>d.value.difficulty=a)},null,512),[[O,d.value.difficulty,void 0,{number:!0}]])]),i("div",El,[l[57]||(l[57]=i("h3",null,"AUDIO CONFIG",-1)),l[58]||(l[58]=i("label",null,"BPM",-1)),D(i("input",{type:"number","onUpdate:modelValue":l[27]||(l[27]=a=>d.value.bpm=a)},null,512),[[O,d.value.bpm,void 0,{number:!0}]]),l[59]||(l[59]=i("label",null,"MEASURE LENGTH (S)",-1)),D(i("input",{type:"number",step:"0.1","onUpdate:modelValue":l[28]||(l[28]=a=>d.value.measureLength=a)},null,512),[[O,d.value.measureLength,void 0,{number:!0}]]),i("div",_l,[l[56]||(l[56]=i("label",null,"AUDIO FILE",-1)),i("button",{onClick:st,class:"upload-btn"},C(d.value.audioData?"AUDIO LOADED":"UPLOAD MP3"),1),i("input",{type:"file",ref_key:"audioInputRef",ref:Ie,accept:"audio/*",style:{display:"none"},onChange:rt},null,544),d.value.audioData?(S(),w("p",Il,"Audio embedded in map data")):L("",!0)])])],2)],2),De.value?(S(),w("div",Dl,[i("div",Ol,[l[60]||(l[60]=i("h2",null,"SMART MAP GENERATION",-1)),i("div",Al,[i("div",Rl,[i("div",{class:"fill",style:xt({width:Me.value+"%"})},null,4)]),i("span",Ll,C(Ke(ze.value))+" ("+C(Me.value.toFixed(0))+"%)",1)]),i("div",Nl,[(S(!0),w(le,null,me(He.value,(a,n)=>(S(),w("div",{key:n,class:"log-line"},C(a),1))),128))]),i("div",Bl,[i("button",{onClick:l[29]||(l[29]=a=>De.value=!1),disabled:Je.value&&Me.value<100,class:"control-btn exit"},"CLOSE",8,Ul)])])])):L("",!0)]))}}),Xl=Ct(Wl,[["__scopeId","data-v-6876bfb9"]]);export{Xl as default};
